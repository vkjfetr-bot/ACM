{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "description": "ACM V10 Dashboard featuring health forecasting, RUL predictions, failure probability curves, and physical sensor forecasting for critical equipment parameters. Includes comprehensive visualizations across 7 sections: Health Timeline, Operating Regimes, Anomaly Detection, Forecasting & RUL, Episode Analysis, Data Quality, and Maintenance Diagnostics.",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 2,
  "id": 0,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 1,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-red",
                "value": 0
              },
              {
                "color": "dark-orange",
                "value": 30
              },
              {
                "color": "dark-yellow",
                "value": 60
              },
              {
                "color": "dark-green",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 3,
        "w": 6,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "vertical",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT TOP 1 ROUND(HealthIndex, 1) AS value, 'Health Score' AS metric FROM ACM_HealthTimeline WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() ORDER BY Timestamp DESC",
          "refId": "A"
        }
      ],
      "title": "Current Health Score",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-green",
                "value": 0
              },
              {
                "color": "dark-yellow",
                "value": 0.5
              },
              {
                "color": "dark-orange",
                "value": 1.5
              },
              {
                "color": "dark-red",
                "value": 2.5
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 3,
        "w": 3,
        "x": 6,
        "y": 0
      },
      "id": 2,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "vertical",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT ROUND(MAX(LatestAbsZ), 2) AS value, 'Anomaly Severity' AS metric FROM ACM_SensorHotspots WHERE EquipID = $equipment",
          "refId": "A"
        }
      ],
      "title": "Max Anomaly Severity (Z-Score)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-blue",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 3,
        "w": 3,
        "x": 9,
        "y": 0
      },
      "id": 3,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT COUNT(DISTINCT RegimeLabel) AS value, 'Operating Regimes' AS metric FROM ACM_RegimeTimeline WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo()",
          "refId": "A"
        }
      ],
      "title": "Active Regimes",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-green",
                "value": 0
              },
              {
                "color": "dark-yellow",
                "value": 3
              },
              {
                "color": "dark-orange",
                "value": 7
              },
              {
                "color": "dark-red",
                "value": 10
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 3,
        "w": 3,
        "x": 12,
        "y": 0
      },
      "id": 4,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "vertical",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT COALESCE(SUM(TotalEpisodes), 0) AS value, 'Episodes Detected' AS metric FROM ACM_EpisodeMetrics WHERE EquipID = $equipment",
          "refId": "A"
        }
      ],
      "title": "Anomaly Episodes",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 3
      },
      "id": 100,
      "panels": [],
      "title": "SYSTEM HEALTH & TIMELINE",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Health Score (%)",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "hue",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": 3600000,
            "lineInterpolation": "smooth",
            "lineWidth": 3,
            "pointSize": 4,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line+area"
            }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-red",
                "value": 0
              },
              {
                "color": "dark-orange",
                "value": 30
              },
              {
                "color": "dark-yellow",
                "value": 60
              },
              {
                "color": "dark-green",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 4
      },
      "id": 11,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "min",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\r\n  Timestamp AS time,\r\n  HealthIndex AS value,\r\n  'Health Score' AS metric\r\nFROM\r\n  ACM_HealthTimeline\r\nWHERE\r\n  EquipID = $equipment\r\n  AND Timestamp BETWEEN $__timeFrom()\r\n  AND $__timeTo()\r\nORDER BY\r\n  Timestamp",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Health Score Timeline",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "scaleDistribution": {
              "type": "linear"
            }
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Events"
            },
            "properties": []
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 24,
        "x": 0,
        "y": 12
      },
      "id": 52,
      "options": {
        "calculate": false,
        "cellGap": 1,
        "color": {
          "exponent": 0.5,
          "fill": "dark-red",
          "mode": "scheme",
          "reverse": true,
          "scale": "exponential",
          "scheme": "Plasma",
          "steps": 64
        },
        "exemplars": {
          "color": "rgba(255,0,255,0.7)"
        },
        "filterValues": {
          "le": 1e-9
        },
        "legend": {
          "show": true
        },
        "rowsFrame": {
          "layout": "auto"
        },
        "tooltip": {
          "mode": "single",
          "showColorScale": false,
          "yHistogram": false
        },
        "yAxis": {
          "axisPlacement": "left",
          "reverse": false
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\r\nDATEADD(HOUR, DATEDIFF(HOUR, 0, StartTime), 0) AS time,\r\nCOUNT(*) AS value,\r\n'Events' AS metric\r\nFROM\r\nACM_Anomaly_Events\r\nWHERE\r\nEquipID = $equipment\r\nAND StartTime BETWEEN $__timeFrom()\r\nAND $__timeTo()\r\nGROUP BY\r\nDATEADD(HOUR, DATEDIFF(HOUR, 0, StartTime), 0)\r\nORDER BY\r\ntime ASC",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Anomaly Events - Detection Timeline",
      "type": "heatmap"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": true,
            "axisColorMode": "text",
            "axisLabel": "OMR Z-Score",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 15,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": 3600000,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 4,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": 3600000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-green",
                "value": 0
              },
              {
                "color": "dark-yellow",
                "value": 2
              },
              {
                "color": "dark-orange",
                "value": 3
              },
              {
                "color": "dark-red",
                "value": 4
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "OMR Score"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#57e7f2",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "value"
            },
            "properties": [
              {
                "id": "min",
                "value": -10
              },
              {
                "id": "max",
                "value": 10
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 18
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "max",
            "min"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT Timestamp AS time, OMR_Z AS value, 'OMR Score' AS metric FROM ACM_OMRTimeline WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() ORDER BY Timestamp",
          "refId": "A"
        }
      ],
      "title": "OMR Detector Score Timeline",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 26
      },
      "id": 101,
      "panels": [],
      "title": "OPERATING REGIMES & STABILITY",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "unit": "percent"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "RegimeName"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "text",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Percentage"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 1
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 4,
        "x": 0,
        "y": 27
      },
      "id": 21,
      "options": {
        "displayLabels": [
          "name",
          "percent",
          "value"
        ],
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true,
          "values": [
            "percent",
            "value"
          ]
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "sort": "asc",
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH RegimeSummary AS (\r\n  SELECT\r\n    CONCAT('Regime ', CAST(RegimeLabel AS VARCHAR)) AS RegimeName,\r\n    RegimeLabel,\r\n    COUNT(*) AS RecordCount,\r\n    CAST(\r\n      COUNT(*) * 100.0 / (\r\n        SELECT\r\n          COUNT(*)\r\n        FROM\r\n          ACM_RegimeTimeline\r\n        WHERE\r\n          EquipID = $equipment\r\n      ) AS DECIMAL(5, 2)\r\n    ) AS Percentage\r\n  FROM\r\n    ACM_RegimeTimeline\r\n  WHERE\r\n    EquipID = $equipment\r\n  GROUP BY\r\n    RegimeLabel\r\n)\r\nSELECT\r\n  RegimeName,\r\n  Percentage\r\nFROM\r\n  RegimeSummary\r\nORDER BY\r\n  Percentage DESC",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Operating Regimes - Occupancy",
      "transformations": [
        {
          "id": "transpose",
          "options": {}
        }
      ],
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "description": "Shows operating regime transitions over time. Panel displays only when multiple regimes are detected in the selected time range. If equipment operates in a single stable regime, this panel will be empty.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisPlacement": "auto",
            "fillOpacity": 70,
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineWidth": 0,
            "spanNulls": false
          },
          "mappings": [
            {
              "options": {
                "Regime 0": {
                  "color": "#50e4ef",
                  "index": 2
                },
                "Regime 1": {
                  "color": "blue",
                  "index": 0
                },
                "Regime 2": {
                  "color": "purple",
                  "index": 1
                }
              },
              "type": "value"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "metric"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "palette-classic"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 20,
        "x": 4,
        "y": 27
      },
      "id": 22,
      "options": {
        "alignValue": "left",
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "mergeValues": true,
        "rowHeight": 0.9,
        "showValue": "auto",
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  Timestamp AS time,\n  CONCAT('Regime ', CAST(RegimeLabel AS VARCHAR)) AS metric,\n  1 AS value\nFROM\n  ACM_RegimeTimeline\nWHERE\n  EquipID = $equipment\n  AND Timestamp BETWEEN $__timeFrom()\n  AND $__timeTo()\n  AND EXISTS (\n    SELECT\n      1\n    FROM\n      (\n        SELECT\n          COUNT(DISTINCT RegimeLabel) AS regime_count\n        FROM\n          ACM_RegimeTimeline\n        WHERE\n          EquipID = $equipment\n          AND Timestamp BETWEEN $__timeFrom()\n          AND $__timeTo()\n      ) AS rc\n    WHERE\n      rc.regime_count > 1\n  )\nORDER BY\n  Timestamp,\n  RegimeLabel",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Regime Timeline - Transitions",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "value": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {}
          }
        }
      ],
      "type": "state-timeline"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 41
      },
      "id": 102,
      "panels": [],
      "title": "ANOMALY DETECTION & DIAGNOSTICS",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "AnomalySeverity"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 1
                    },
                    {
                      "color": "dark-orange",
                      "value": 2
                    },
                    {
                      "color": "dark-red",
                      "value": 3
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "AlertCount"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-text"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "text",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 5
                    },
                    {
                      "color": "dark-red",
                      "value": 10
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 42
      },
      "id": 31,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "AnomalySeverity"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT TOP 15 SensorName, ROUND(LatestAbsZ, 2) AS AnomalySeverity, AboveAlertCount AS AlertCount, FORMAT(MaxTimestamp, 'yyyy-MM-dd HH:mm') AS PeakTime FROM ACM_SensorHotspots WHERE EquipID = $equipment ORDER BY LatestAbsZ DESC",
          "refId": "A"
        }
      ],
      "title": "Top Anomalous Sensors - Ranked by Severity",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "fieldMinMax": true,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "AvgContribution"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "gauge"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-blue",
                      "value": 0
                    },
                    {
                      "color": "dark-green",
                      "value": 10
                    },
                    {
                      "color": "dark-yellow",
                      "value": 30
                    },
                    {
                      "color": "dark-orange",
                      "value": 50
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "MaxContribution"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "gauge"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byType",
              "options": "number"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "lcd",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-YlRd"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 42
      },
      "id": 32,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Occurrences"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT TOP 15 DetectorType AS SensorName, ROUND(AVG(ContributionPct), 2) AS AvgContribution, ROUND(MAX(ContributionPct), 2) AS MaxContribution, COUNT(*) AS Occurrences FROM ACM_ContributionTimeline WHERE EquipID = $equipment AND ContributionPct > 0 GROUP BY DetectorType ORDER BY AvgContribution DESC",
          "refId": "A"
        }
      ],
      "title": "Top OMR Contributing Features - Ranked by Avg Impact",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 51
      },
      "id": 103,
      "panels": [],
      "title": "FORECASTING & RUL",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "description": "Health forecast with 95% confidence intervals showing prediction uncertainty. The shaded band represents the range within which the true health value is expected to fall with 95% probability.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Health Score (%)",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": 3600000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Forecast"
            },
            "properties": [
              {
                "id": "custom.lineWidth",
                "value": 3
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Lower 95% CI"
            },
            "properties": [
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    5
                  ],
                  "fill": "dash"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.lineWidth",
                "value": 1
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "light-blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Upper 95% CI"
            },
            "properties": [
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    5
                  ],
                  "fill": "dash"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.lineWidth",
                "value": 1
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "light-blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 52
      },
      "id": 110,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "min",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT Timestamp AS time, ForecastHealth AS value, 'Forecast' AS metric FROM ACM_HealthForecast_Continuous WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() ORDER BY Timestamp ASC",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT Timestamp AS time, CI_Lower AS value, 'Lower 95% CI' AS metric FROM ACM_HealthForecast_Continuous WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() ORDER BY Timestamp ASC",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT Timestamp AS time, CI_Upper AS value, 'Upper 95% CI' AS metric FROM ACM_HealthForecast_Continuous WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() ORDER BY Timestamp ASC",
          "refId": "C"
        }
      ],
      "title": "Health Forecast with Confidence Intervals",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-green",
                "value": 0
              },
              {
                "color": "dark-yellow",
                "value": 168
              },
              {
                "color": "dark-orange",
                "value": 72
              },
              {
                "color": "dark-red",
                "value": 24
              }
            ]
          },
          "unit": "h"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "RUL (h)"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "decimals",
                "value": 1
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Status"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-text"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "Healthy": {
                        "color": "dark-green",
                        "index": 0
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "Caution": {
                        "color": "dark-yellow",
                        "index": 1
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "Warning": {
                        "color": "dark-orange",
                        "index": 2
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "Critical": {
                        "color": "dark-red",
                        "index": 3
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Confidence"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "gauge"
                }
              },
              {
                "id": "decimals",
                "value": 3
              },
              {
                "id": "unit",
                "value": "percentunit"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 3,
        "w": 24,
        "x": 0,
        "y": 61
      },
      "id": 42,
      "options": {
        "cellHeight": "md",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT TOP 1 Method, ROUND(RUL_Hours, 1) AS 'RUL (h)', ROUND(Confidence, 3) AS 'Confidence', CASE WHEN RUL_Hours > 168 THEN 'Healthy' WHEN RUL_Hours > 72 THEN 'Caution' WHEN RUL_Hours > 24 THEN 'Warning' ELSE 'Critical' END AS 'Status' FROM ACM_RUL WHERE EquipID = $equipment AND (P10_LowerBound IS NOT NULL OR P50_Median IS NOT NULL) ORDER BY CreatedAt DESC",
          "refId": "A"
        }
      ],
      "title": "Remaining Useful Life - RUL Summary",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "description": "RUL prediction uncertainty over time showing P10 (pessimistic), P50 (median), and P90 (optimistic) bounds from Monte Carlo simulations. Narrower bands indicate higher prediction confidence.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "RUL (hours)",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 15,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 4,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": 3600000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-red",
                "value": 0
              },
              {
                "color": "dark-orange",
                "value": 24
              },
              {
                "color": "dark-yellow",
                "value": 72
              },
              {
                "color": "dark-green",
                "value": 168
              }
            ]
          },
          "unit": "h"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "P50 Median"
            },
            "properties": [
              {
                "id": "custom.lineWidth",
                "value": 3
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "P10 Lower"
            },
            "properties": [
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    8,
                    4
                  ],
                  "fill": "dash"
                }
              },
              {
                "id": "custom.lineWidth",
                "value": 1
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "P90 Upper"
            },
            "properties": [
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    8,
                    4
                  ],
                  "fill": "dash"
                }
              },
              {
                "id": "custom.lineWidth",
                "value": 1
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 64
      },
      "id": 108,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "min",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT CreatedAt AS time, P50_Median AS value, 'P50 Median' AS metric FROM ACM_RUL WHERE EquipID = $equipment AND P50_Median IS NOT NULL AND CreatedAt BETWEEN $__timeFrom() AND $__timeTo() ORDER BY CreatedAt ASC",
          "refId": "A"
        },
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT CreatedAt AS time, P10_LowerBound AS value, 'P10 Lower' AS metric FROM ACM_RUL WHERE EquipID = $equipment AND P10_LowerBound IS NOT NULL AND CreatedAt BETWEEN $__timeFrom() AND $__timeTo() ORDER BY CreatedAt ASC",
          "refId": "B"
        },
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT CreatedAt AS time, P90_UpperBound AS value, 'P90 Upper' AS metric FROM ACM_RUL WHERE EquipID = $equipment AND P90_UpperBound IS NOT NULL AND CreatedAt BETWEEN $__timeFrom() AND $__timeTo() ORDER BY CreatedAt ASC",
          "refId": "C"
        }
      ],
      "title": "RUL Uncertainty Bands (P10/P50/P90 Over Time)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Failure Probability",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 25,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": 3600000,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": 3600000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "decimals": 3,
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-green",
                "value": 0
              },
              {
                "color": "dark-yellow",
                "value": 0.3
              },
              {
                "color": "dark-orange",
                "value": 0.6
              },
              {
                "color": "dark-red",
                "value": 0.8
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Failure Probability"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd",
                  "seriesBy": "last"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "value"
            },
            "properties": [
              {
                "id": "min",
                "value": 0
              },
              {
                "id": "max",
                "value": 1
              },
              {
                "id": "unit",
                "value": "percentunit"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 73
      },
      "id": 43,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT Timestamp AS time, ROUND(FailureProb, 3) AS value, 'Failure Probability (Continuous)' AS metric FROM ACM_FailureHazard_TS WHERE EquipID = $equipment AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() ORDER BY Timestamp ASC",
          "refId": "A"
        }
      ],
      "title": "Failure Probability Forecast - 7 Day Outlook",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Sensor Value",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": 3600000,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 16,
        "x": 0,
        "y": 82
      },
      "id": 44,
      "options": {
        "legend": {
          "calcs": [
            "last",
            "mean"
          ],
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "WITH TopSensors AS (\r\n  SELECT TOP 5 SensorName\r\n  FROM ACM_SensorHotspots\r\n  WHERE EquipID = $equipment\r\n  ORDER BY LatestAbsZ DESC\r\n)\r\nSELECT\r\n  sn.Timestamp AS time,\r\n  sn.SensorName AS metric,\r\n  ROUND(sn.ZScore, 2) AS value\r\nFROM ACM_SensorNormalized_TS sn\r\nINNER JOIN TopSensors ts ON sn.SensorName = ts.SensorName\r\nWHERE sn.EquipID = $equipment\r\n  AND sn.Timestamp BETWEEN $__timeFrom() AND $__timeTo()\r\nORDER BY sn.Timestamp ASC",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Sensor Evolution",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Trend"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "gauge"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-blue",
                      "value": 0
                    },
                    {
                      "color": "dark-green",
                      "value": 5
                    },
                    {
                      "color": "dark-yellow",
                      "value": 10
                    },
                    {
                      "color": "dark-red",
                      "value": 20
                    }
                  ]
                }
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Avg"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 8,
        "x": 16,
        "y": 82
      },
      "id": 45,
      "options": {
        "cellHeight": "md",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Trend"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH SensorTrends AS (SELECT SensorName, MIN(ForecastValue) AS MinValue, MAX(ForecastValue) AS MaxValue, AVG(ForecastValue) AS AvgValue, (MAX(ForecastValue) - MIN(ForecastValue)) AS TrendRange, Method, COUNT(*) AS DataPoints FROM ACM_SensorForecast WHERE EquipID = $equipment GROUP BY SensorName, Method) SELECT TOP 10 CASE WHEN LEN(SensorName) > 40 THEN LEFT(SensorName, 37) + '...' ELSE SensorName END AS 'Sensor', ROUND(TrendRange, 2) AS 'Trend', ROUND(AvgValue, 2) AS 'Avg', Method FROM SensorTrends ORDER BY TrendRange DESC",
          "refId": "A"
        }
      ],
      "title": "Sensor Forecast Summary - Top Changing Sensors",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "description": "Physical sensor forecast trajectories for top 5 sensors with highest predicted variation. Shows VAR(4) multivariate forecast predictions.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Sensor Value",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": 3600000,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 4,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": 1800000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 91
      },
      "id": 109,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "min",
            "max"
          ],
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "WITH TopSensors AS (SELECT TOP 5 SensorName FROM (SELECT SensorName, MAX(ForecastValue) - MIN(ForecastValue) AS TrendRange FROM ACM_SensorForecast WHERE EquipID = $equipment GROUP BY SensorName) AS Trends ORDER BY TrendRange DESC) SELECT Timestamp AS time, AVG(ForecastValue) AS value, SensorName AS metric FROM ACM_SensorForecast WHERE EquipID = $equipment AND SensorName IN (SELECT SensorName FROM TopSensors) AND Timestamp BETWEEN $__timeFrom() AND $__timeTo() GROUP BY Timestamp, SensorName ORDER BY Timestamp ASC",
          "refId": "A"
        }
      ],
      "title": "Sensor Forecast Time-Series (Top 5 Dynamic Sensors)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Episodes"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 5
                    },
                    {
                      "color": "dark-orange",
                      "value": 10
                    },
                    {
                      "color": "dark-red",
                      "value": 20
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Avg Duration"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "unit",
                "value": "h"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Max Duration"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "unit",
                "value": "h"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Episodes/Day"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 100
      },
      "id": 51,
      "options": {
        "cellHeight": "md",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT SUM(TotalEpisodes) AS 'Episodes', ROUND(AVG(AvgDurationHours), 2) AS 'Avg Duration', ROUND(MAX(MaxDurationHours), 2) AS 'Max Duration', ROUND(AVG(RatePerDay), 2) AS 'Episodes/Day' FROM ACM_EpisodeMetrics WHERE EquipID = $equipment",
          "refId": "A"
        }
      ],
      "title": "Episode Statistics",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-red",
            "mode": "fixed"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Event Count",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "bars",
            "fillOpacity": 100,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": 3600000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Events"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 100
      },
      "id": 107,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\r\nDATEADD(HOUR, DATEDIFF(HOUR, 0, StartTime), 0) AS time,\r\nCOUNT(*) AS value,\r\n'Events' AS metric\r\nFROM\r\nACM_Anomaly_Events\r\nWHERE\r\nEquipID = $equipment\r\nAND StartTime BETWEEN $__timeFrom()\r\nAND $__timeTo()\r\nGROUP BY\r\nDATEADD(HOUR, DATEDIFF(HOUR, 0, StartTime), 0)\r\nORDER BY\r\ntime ASC",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Anomaly Events - Detection Timeline",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Drift Score",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": 3600000,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "decimals": 3,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "dark-green",
                "value": 0
              },
              {
                "color": "dark-yellow",
                "value": 0.3
              },
              {
                "color": "dark-orange",
                "value": 0.5
              },
              {
                "color": "dark-red",
                "value": 0.7
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Drift Score"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 106
      },
      "id": 53,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT Timestamp AS time, DriftValue AS value, 'Drift Score' AS metric FROM ACM_DriftSeries WHERE EquipID = $equipment ORDER BY Timestamp DESC OFFSET 0 ROWS FETCH NEXT 500 ROWS ONLY",
          "refId": "A"
        }
      ],
      "title": "Model Drift Detection - Concept Drift Evolution",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 114
      },
      "id": 104,
      "panels": [],
      "title": "EPISODE & DRIFT ANALYSIS",
      "type": "row"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 115
      },
      "id": 105,
      "panels": [],
      "title": "DATA QUALITY & CONFIGURATION",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "MissingPct"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 5
                    },
                    {
                      "color": "dark-orange",
                      "value": 15
                    },
                    {
                      "color": "dark-red",
                      "value": 30
                    }
                  ]
                }
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "decimals",
                "value": 1
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Status"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-text"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "PASS": {
                        "color": "dark-green",
                        "index": 0
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "WARN": {
                        "color": "dark-yellow",
                        "index": 1
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "FAIL": {
                        "color": "dark-red",
                        "index": 2
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "LongestGap"
            },
            "properties": [
              {
                "id": "unit",
                "value": "s"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "FlatlineSpan"
            },
            "properties": [
              {
                "id": "unit",
                "value": "s"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 116
      },
      "id": 61,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "MissingPct"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH latest_run AS (SELECT TOP 1 RunID FROM ACM_DataQuality WHERE EquipID = $equipment ORDER BY COALESCE(score_max_ts, train_max_ts) DESC) SELECT TOP 50 sensor AS 'SensorName', COALESCE(score_null_pct, train_null_pct, 0) AS 'MissingPct', score_longest_gap AS 'LongestGap', score_flatline_span AS 'FlatlineSpan', sampling_secs AS 'SamplingSeconds', CheckResult AS 'Status' FROM ACM_DataQuality dq WHERE dq.EquipID = $equipment AND dq.RunID = (SELECT RunID FROM latest_run) ORDER BY MissingPct DESC, LongestGap DESC",
          "refId": "A"
        }
      ],
      "title": "Data Quality Assessment",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "fieldMinMax": true,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Fusion Weight"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "gauge"
                }
              },
              {
                "id": "decimals",
                "value": 4
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-blue",
                      "value": 0
                    },
                    {
                      "color": "dark-green",
                      "value": 0.1
                    },
                    {
                      "color": "dark-yellow",
                      "value": 0.3
                    },
                    {
                      "color": "dark-orange",
                      "value": 0.5
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Mean Z"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "gauge"
                }
              },
              {
                "id": "fieldMinMax",
                "value": true
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Max Z"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 2
                    },
                    {
                      "color": "dark-orange",
                      "value": 3
                    },
                    {
                      "color": "dark-red",
                      "value": 4
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 116
      },
      "id": 62,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Fusion Weight"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT Detector, ROUND(AVG(Weight), 4) AS 'Fusion Weight', ROUND(AVG(MeanZ), 2) AS 'Mean Z', ROUND(MAX(MaxZ), 2) AS 'Max Z' FROM ACM_FusionQualityReport WHERE EquipID = $equipment GROUP BY Detector ORDER BY AVG(Weight) DESC",
          "refId": "A"
        }
      ],
      "title": "Detector Fusion Weights & Performance",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 124
      },
      "id": 106,
      "panels": [],
      "title": "MAINTENANCE & DIAGNOSTICS",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Failure Prob"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "decimals",
                "value": 3
              },
              {
                "id": "unit",
                "value": "percentunit"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 0.3
                    },
                    {
                      "color": "dark-orange",
                      "value": 0.6
                    },
                    {
                      "color": "dark-red",
                      "value": 0.8
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Priority"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "pill"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "LOW": {
                        "color": "dark-green",
                        "index": 0
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "MEDIUM": {
                        "color": "dark-yellow",
                        "index": 1
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "HIGH": {
                        "color": "dark-orange",
                        "index": 2
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "CRITICAL": {
                        "color": "dark-red",
                        "index": 3
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 5,
        "w": 24,
        "x": 0,
        "y": 125
      },
      "id": 71,
      "options": {
        "cellHeight": "md",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "Recommended By"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "-- Combine RUL with current health status\r\nSELECT\r\n  TOP 1 r.Method AS 'Method',\r\n  ROUND(r.RUL_Hours, 1) AS 'RUL Hours',\r\n  ROUND(r.P10_LowerBound, 1) AS 'P10',\r\n  ROUND(r.P90_UpperBound, 1) AS 'P90',\r\n  ROUND(r.Confidence, 3) AS 'Confidence',\r\n  CASE\r\n    WHEN r.RUL_Hours < 24 THEN 'CRITICAL'\r\n    WHEN r.RUL_Hours < 72 THEN 'HIGH'\r\n    WHEN r.RUL_Hours < 168 THEN 'MEDIUM'\r\n    ELSE 'LOW'\r\n  END AS 'Priority',\r\n  FORMAT(r.FailureTime, 'yyyy-MM-dd HH:mm') AS 'Est. Failure Time',\r\n  DATEDIFF(DAY, GETDATE(), r.FailureTime) AS 'Days Left',\r\n  r.TopSensor1 AS 'Top Culprit Sensor',\r\n  -- Add current health to validate RUL prediction\r\n  (\r\n    SELECT\r\n      TOP 1 ROUND(HealthIndex, 1)\r\n    FROM\r\n      ACM_HealthTimeline\r\n    WHERE\r\n      EquipID = $equipment\r\n    ORDER BY\r\n      Timestamp DESC\r\n  ) AS 'Current Health',\r\n  (\r\n    SELECT\r\n      TOP 1 HealthZone\r\n    FROM\r\n      ACM_HealthTimeline\r\n    WHERE\r\n      EquipID = $equipment\r\n    ORDER BY\r\n      Timestamp DESC\r\n  ) AS 'Health Zone',\r\n  -- Add active defect count for context\r\n  (\r\n    SELECT\r\n      COUNT(*)\r\n    FROM\r\n      ACM_SensorDefects\r\n    WHERE\r\n      EquipID = $equipment\r\n      AND RunID = r.RunID\r\n      AND ActiveDefect = 1\r\n  ) AS 'Active Defects'\r\nFROM\r\n  ACM_RUL r\r\nWHERE\r\n  r.EquipID = $equipment\r\n  AND (\r\n    r.P10_LowerBound IS NOT NULL\r\n    OR r.P50_Median IS NOT NULL\r\n  )\r\nORDER BY\r\n  r.CreatedAt DESC;",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Maintenance Recommendations - Scheduled Windows",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "description": " Note: Shows cumulative defect statistics across all runs. For time-filtered defects, see Episode Diagnostics panel.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "fieldMinMax": true,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Current Z"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 1
                    },
                    {
                      "color": "dark-orange",
                      "value": 2
                    },
                    {
                      "color": "dark-red",
                      "value": 3
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Severity"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "CAUTION": {
                        "color": "dark-yellow",
                        "index": 2
                      },
                      "CRITICAL": {
                        "color": "dark-red",
                        "index": 0
                      },
                      "WARNING": {
                        "color": "dark-orange",
                        "index": 1
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Violation %"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "gauge"
                }
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "decimals",
                "value": 1
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green",
                      "value": 0
                    },
                    {
                      "color": "dark-yellow",
                      "value": 10
                    },
                    {
                      "color": "dark-orange",
                      "value": 30
                    },
                    {
                      "color": "dark-red",
                      "value": 50
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Peak Z"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Avg Z"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Status"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "Active": {
                        "color": "dark-red",
                        "index": 0
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "Historical": {
                        "color": "dark-blue",
                        "index": 1
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Violations"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-YlRd"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 130
      },
      "id": 72,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Violation %"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT TOP 20 DetectorType AS 'Detector', Severity, ViolationCount AS 'Violations', ROUND(ViolationPct, 1) AS 'Violation %', ROUND(MaxZ, 2) AS 'Peak Z', ROUND(AvgZ, 2) AS 'Avg Z', ROUND(CurrentZ, 2) AS 'Current Z', CASE WHEN ActiveDefect = 1 THEN 'Active' ELSE 'Historical' END AS 'Status' FROM ACM_SensorDefects WHERE EquipID = $equipment ORDER BY ViolationPct DESC",
          "refId": "A"
        }
      ],
      "title": "Defect Analysis - Sensor Violations by Detector",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${datasource}"
      },
      "description": "Real-time ACM run logs showing errors, warnings, and info messages. Filtered by equipment and time range.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "filterable": true,
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Level"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "ERROR": {
                        "color": "red",
                        "index": 0
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "WARNING": {
                        "color": "orange",
                        "index": 1
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "INFO": {
                        "color": "green",
                        "index": 2
                      }
                    },
                    "type": "value"
                  }
                ]
              },
              {
                "id": "custom.width",
                "value": 170
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Timestamp"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 244
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Message"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 1816
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 138
      },
      "id": 99,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Timestamp"
          }
        ]
      },
      "pluginVersion": "12.2.1",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${datasource}"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT TOP 100 LoggedAt AS 'Timestamp', Level, Message FROM ACM_RunLogs WHERE EquipID = $equipment AND LoggedAt BETWEEN $__timeFrom() AND $__timeTo() ORDER BY LoggedAt DESC",
          "refId": "A"
        }
      ],
      "title": "Run Logs - Latest Events (Top 100 in Time Range)",
      "type": "table"
    }
  ],
  "preload": false,
  "refresh": "30s",
  "schemaVersion": 42,
  "tags": [
    "v10"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "text": "B19CL3PCSQLSERVER",
          "value": "cf42m5bbjxmo0e"
        },
        "includeAll": false,
        "label": "Data Source",
        "name": "datasource",
        "options": [],
        "query": "mssql",
        "refresh": 1,
        "regex": "",
        "type": "datasource"
      },
      {
        "current": {
          "text": "Forced Draft Fan",
          "value": "1"
        },
        "datasource": {
          "type": "mssql",
          "uid": "${datasource}"
        },
        "definition": "SELECT CAST(EquipID AS VARCHAR) AS __value, COALESCE(EquipName, CONCAT('Equipment-', CAST(EquipID AS VARCHAR))) AS __text FROM Equipment ORDER BY EquipName",
        "includeAll": false,
        "label": "Equipment",
        "name": "equipment",
        "options": [],
        "query": "SELECT CAST(EquipID AS VARCHAR) AS __value, COALESCE(EquipName, CONCAT('Equipment-', CAST(EquipID AS VARCHAR))) AS __text FROM Equipment ORDER BY EquipName",
        "refresh": 1,
        "regex": "",
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "now-5y",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "Asset Health Dashboard v10 - Comprehensive System Overview with Predictive Analytics",
  "uid": "asset_health_v10",
  "version": 62
}