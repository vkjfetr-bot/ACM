{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 0,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "datasource",
        "uid": "grafana"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 33,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "SVGBaseFix": true,
        "add100Percentage": true,
        "calcsMutation": "standard",
        "centerAlignContent": true,
        "codeData": "{\n  \"text\": \"Random text\"\n}",
        "css": "* {\n  box-sizing: border-box;\n}\n\n.acm-cc {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: radial-gradient(circle at top left, #fefefe 0, var(--acm-bg-page) 55%);\n  font-family: var(--acm-font-sans);\n  color: var(--acm-text-main);\n}\n\n/* HEADER */\n\n.acm-cc__header {\n  display: flex;\n  justify-content: space-between;\n  align-items: stretch;\n  padding: var(--acm-space-md) var(--acm-space-lg);\n  background: var(--acm-bg-header);\n  border-bottom: 1px solid var(--acm-border-soft);\n  gap: var(--acm-space-lg);\n}\n\n.acm-cc__header-left {\n  display: flex;\n  align-items: center;\n  gap: var(--acm-space-md);\n}\n\n.acm-cc__status-dot {\n  width: 18px;\n  height: 18px;\n  border-radius: 999px;\n  background: var(--acm-status-good);\n  box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.18);\n  flex-shrink: 0;\n  transition: background 0.2s ease, box-shadow 0.2s ease;\n}\n\n.acm-cc__status-dot--watch {\n  background: var(--acm-status-watch);\n  box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.18);\n}\n\n.acm-cc__status-dot--alert,\n.acm-cc__status-dot--critical {\n  background: var(--acm-status-alert);\n  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.2);\n}\n\n.acm-cc__title {\n  font-size: 18px;\n  font-weight: 600;\n  margin: 0 0 2px;\n  letter-spacing: 0.02em;\n}\n\n.acm-cc__subtitle {\n  font-size: 11px;\n  color: var(--acm-text-muted);\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n\n.acm-cc__divider {\n  color: var(--acm-text-soft);\n}\n\n.acm-cc__header-right {\n  display: grid;\n  grid-template-columns: repeat(4, minmax(0, 1fr));\n  gap: var(--acm-space-sm);\n  min-width: 520px;\n}\n\n.acm-cc__metric-card {\n  background: var(--acm-bg-panel);\n  border-radius: var(--acm-radius-md);\n  border: 1px solid var(--acm-border-soft);\n  padding: 8px 10px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.acm-cc__metric-label {\n  font-size: 10px;\n  text-transform: uppercase;\n  letter-spacing: 0.06em;\n  color: var(--acm-text-soft);\n  margin-bottom: 2px;\n}\n\n.acm-cc__metric-value {\n  font-size: 18px;\n  font-weight: 600;\n  font-family: var(--acm-font-mono);\n  margin-bottom: 2px;\n}\n\n.acm-cc__metric-sub {\n  font-size: 11px;\n  color: var(--acm-text-muted);\n}\n\n/* MAIN LAYOUT */\n\n.acm-cc__main {\n  flex: 1;\n  padding: var(--acm-space-md);\n  display: flex;\n  flex-direction: column;\n  gap: var(--acm-space-md);\n}\n\n.acm-cc__row {\n  display: grid;\n  gap: var(--acm-space-md);\n}\n\n.acm-cc__row--top {\n  grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.1fr);\n  min-height: 0;\n}\n\n.acm-cc__row--bottom {\n  grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.1fr) minmax(0, 1.0fr);\n  min-height: 0;\n}\n\n/* PANELS */\n\n.acm-cc__panel {\n  background: var(--acm-bg-panel);\n  border-radius: var(--acm-radius-lg);\n  border: 1px solid var(--acm-border-soft);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  min-height: 0;\n}\n\n.acm-cc__panel-header {\n  padding: 8px 12px;\n  border-bottom: 1px solid var(--acm-border-soft);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(to right, #ffffff, #f9fafb);\n}\n\n.acm-cc__panel-title {\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.08em;\n  color: var(--acm-text-muted);\n}\n\n.acm-cc__panel-meta {\n  font-size: 11px;\n  color: var(--acm-text-soft);\n}\n\n.acm-cc__panel-subtitle {\n  padding: 8px 12px 4px;\n  font-size: 11px;\n  font-weight: 500;\n  color: var(--acm-text-muted);\n}\n\n.acm-cc__panel-subtitle--compact {\n  padding-top: 6px;\n}\n\n/* TIMELINE */\n\n.acm-cc__panel--timeline {\n  min-height: 220px;\n}\n\n.acm-cc__timeline-canvas {\n  flex: 1;\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n.acm-cc__legend {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10px;\n  padding: 6px 10px 8px;\n  border-top: 1px solid var(--acm-border-soft);\n  background: #f9fafb;\n}\n\n.acm-cc__legend-item {\n  font-size: 11px;\n  color: var(--acm-text-muted);\n  display: inline-flex;\n  align-items: center;\n  gap: 5px;\n}\n\n.acm-cc__legend-dot {\n  width: 10px;\n  height: 10px;\n  border-radius: 999px;\n}\n\n.acm-cc__legend-dot--health {\n  background: #2563eb;\n}\n\n.acm-cc__legend-dot--fused {\n  background: #7c2d12;\n}\n\n.acm-cc__legend-pill {\n  height: 8px;\n  width: 18px;\n  border-radius: 999px;\n  border: 1px solid transparent;\n}\n\n.acm-cc__legend-pill--good {\n  background: rgba(22, 163, 74, 0.08);\n  border-color: rgba(22, 163, 74, 0.4);\n}\n\n.acm-cc__legend-pill--watch {\n  background: rgba(249, 115, 22, 0.08);\n  border-color: rgba(249, 115, 22, 0.4);\n}\n\n.acm-cc__legend-pill--alert {\n  background: rgba(220, 38, 38, 0.08);\n  border-color: rgba(220, 38, 38, 0.4);\n}\n\n/* GAUGE + ZONES + CONTRIBUTIONS */\n\n.acm-cc__gauge-wrap {\n  padding: 8px 12px 4px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 6px;\n}\n\n.acm-cc__gauge {\n  width: 100%;\n  max-width: 260px;\n}\n\n.acm-cc__gauge-text {\n  font-size: 26px;\n  font-weight: 600;\n  font-family: var(--acm-font-mono);\n  fill: var(--acm-text-main);\n}\n\n.acm-cc__zone-strip {\n  display: flex;\n  justify-content: center;\n  gap: 10px;\n  font-size: 10px;\n  color: var(--acm-text-muted);\n  margin-top: 0;\n}\n\n.acm-cc__zone-item {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.acm-cc__zone-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 999px;\n}\n\n.acm-cc__zone-dot--good {\n  background: var(--acm-status-good);\n}\n\n.acm-cc__zone-dot--watch {\n  background: var(--acm-status-watch);\n}\n\n.acm-cc__zone-dot--alert {\n  background: var(--acm-status-alert);\n}\n\n.acm-cc__zone-bars {\n  width: 100%;\n  max-width: 260px;\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 4px;\n  margin-top: 4px;\n}\n\n.acm-cc__zone-bar {\n  background: #f3f4f6;\n  border-radius: 999px;\n  height: 14px;\n  overflow: hidden;\n  position: relative;\n}\n\n.acm-cc__zone-bar-fill {\n  height: 100%;\n  border-radius: 999px;\n  transition: width 0.35s ease;\n}\n\n.acm-cc__zone-bar-label {\n  position: absolute;\n  inset: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 9px;\n  color: #111827;\n}\n\n/* DETECTOR CONTRIBUTIONS */\n\n.acm-cc__contrib-list {\n  padding: 4px 12px 10px;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  max-height: 120px;\n  overflow-y: auto;\n}\n\n.acm-cc__contrib-row {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.acm-cc__contrib-label {\n  flex: 0 0 70px;\n  font-size: 11px;\n  font-family: var(--acm-font-mono);\n  color: var(--acm-text-muted);\n  text-align: right;\n}\n\n.acm-cc__contrib-track {\n  flex: 1;\n  height: 14px;\n  border-radius: 999px;\n  background: #edf2ff;\n  position: relative;\n  overflow: hidden;\n}\n\n.acm-cc__contrib-fill {\n  height: 100%;\n  background: #4f46e5;\n  border-radius: 999px;\n  transition: width 0.4s ease;\n}\n\n.acm-cc__contrib-value {\n  position: absolute;\n  right: 6px;\n  top: 50%;\n  transform: translateY(-50%);\n  font-size: 10px;\n  color: white;\n}\n\n/* TABLES (SENSORS / CALIBRATION) */\n\n.acm-cc__table-wrap {\n  flex: 1;\n  overflow: auto;\n}\n\n.acm-cc__table-wrap--compact {\n  max-height: 170px;\n}\n\n.acm-cc__table {\n  width: 100%;\n  border-collapse: collapse;\n  font-size: 11px;\n}\n\n.acm-cc__table th,\n.acm-cc__table td {\n  padding: 6px 8px;\n  border-bottom: 1px solid var(--acm-border-soft);\n}\n\n.acm-cc__table th {\n  position: sticky;\n  top: 0;\n  background: #f9fafb;\n  text-align: left;\n  font-weight: 600;\n  color: var(--acm-text-soft);\n  z-index: 1;\n}\n\n.acm-cc__table tbody tr:hover {\n  background: #f3f4ff;\n}\n\n.acm-cc__table--small th,\n.acm-cc__table--small td {\n  padding: 4px 6px;\n}\n\n/* SENSOR STATUS CHIPS */\n\n.acm-cc__chip {\n  display: inline-flex;\n  align-items: center;\n  padding: 2px 6px;\n  border-radius: 999px;\n  font-size: 10px;\n  font-weight: 500;\n}\n\n.acm-cc__chip--good {\n  background: rgba(22, 163, 74, 0.09);\n  color: #166534;\n}\n\n.acm-cc__chip--warn {\n  background: rgba(249, 115, 22, 0.08);\n  color: #9a3412;\n}\n\n.acm-cc__chip--alert {\n  background: rgba(220, 38, 38, 0.08);\n  color: #b91c1c;\n}\n\n/* EPISODES */\n\n.acm-cc__episode-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 6px 10px 4px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.acm-cc__episode-item {\n  border-radius: var(--acm-radius-sm);\n  border: 1px solid var(--acm-border-soft);\n  padding: 6px 8px;\n  background: #f9fafb;\n}\n\n.acm-cc__episode-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2px;\n}\n\n.acm-cc__episode-id {\n  font-family: var(--acm-font-mono);\n  font-size: 11px;\n}\n\n.acm-cc__episode-badge {\n  font-size: 10px;\n  padding: 2px 6px;\n  border-radius: 999px;\n  font-weight: 600;\n}\n\n.acm-cc__episode-badge--critical {\n  background: #b91c1c;\n  color: #fff;\n}\n\n.acm-cc__episode-badge--high {\n  background: #dc2626;\n  color: #fff;\n}\n\n.acm-cc__episode-badge--medium {\n  background: #f97316;\n  color: #111827;\n}\n\n.acm-cc__episode-badge--low {\n  background: #16a34a;\n  color: #ffffff;\n}\n\n.acm-cc__episode-body {\n  font-size: 11px;\n  color: var(--acm-text-muted);\n}\n\n.acm-cc__episode-meta {\n  font-size: 10px;\n  color: var(--acm-text-soft);\n  margin-top: 2px;\n}\n\n/* SMALL GRID (EPISODE STATS) */\n\n.acm-cc__small-grid {\n  padding: 6px 10px 8px;\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n  gap: 4px;\n  font-size: 11px;\n}\n\n.acm-cc__small-stat {\n  padding: 4px 6px;\n  border-radius: var(--acm-radius-sm);\n  background: #f9fafb;\n  border: 1px solid var(--acm-border-soft);\n}\n\n.acm-cc__small-stat-label {\n  font-size: 10px;\n  color: var(--acm-text-soft);\n  margin-bottom: 1px;\n}\n\n.acm-cc__small-stat-value {\n  font-family: var(--acm-font-mono);\n}\n\n/* MAINTENANCE BLOCK */\n\n.acm-cc__maint {\n  padding: 6px 10px 10px;\n  font-size: 11px;\n}\n\n.acm-cc__maint-line {\n  margin-bottom: 2px;\n  color: var(--acm-text-muted);\n}\n\n/* RESPONSIVE */\n\n@media (max-width: 1400px) {\n  .acm-cc__header-right {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n  }\n\n  .acm-cc__row--bottom {\n    grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.1fr);\n    grid-auto-rows: minmax(0, 1fr);\n  }\n\n  .acm-cc__panel--side {\n    grid-column: 1 / -1;\n  }\n}\n\n/* SCROLLBARS */\n\n.acm-cc__table-wrap::-webkit-scrollbar,\n.acm-cc__episode-list::-webkit-scrollbar,\n.acm-cc__contrib-list::-webkit-scrollbar {\n  width: 6px;\n}\n\n.acm-cc__table-wrap::-webkit-scrollbar-thumb,\n.acm-cc__episode-list::-webkit-scrollbar-thumb,\n.acm-cc__contrib-list::-webkit-scrollbar-thumb {\n  background: #d4d4d8;\n  border-radius: 999px;\n}\n",
        "dynamicData": false,
        "dynamicFieldDisplayValues": false,
        "dynamicHtmlGraphics": false,
        "dynamicProps": false,
        "html": "<div class=\"acm-cc\">\n  <!-- HEADER -->\n  <header class=\"acm-cc__header\">\n    <div class=\"acm-cc__header-left\">\n      <div class=\"acm-cc__status-dot\" id=\"ccStatusDot\"></div>\n      <div>\n        <h1 class=\"acm-cc__title\">ACM Command Center</h1>\n        <div class=\"acm-cc__subtitle\">\n          <span id=\"ccEquipId\">Equipment: --</span>\n          <span class=\"acm-cc__divider\">|</span>\n          <span id=\"ccRegime\">Regime: --</span>\n          <span class=\"acm-cc__divider\">|</span>\n          <span id=\"ccLastUpdate\">Last update: --</span>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"acm-cc__header-right\">\n      <div class=\"acm-cc__metric-card\">\n        <div class=\"acm-cc__metric-label\">Health index</div>\n        <div class=\"acm-cc__metric-value\" id=\"ccHealthValue\">--</div>\n        <div class=\"acm-cc__metric-sub\" id=\"ccHealthStatus\">Status: --</div>\n      </div>\n      <div class=\"acm-cc__metric-card\">\n        <div class=\"acm-cc__metric-label\">Fused z-score</div>\n        <div class=\"acm-cc__metric-value\" id=\"ccFusedZ\">--</div>\n        <div class=\"acm-cc__metric-sub\" id=\"ccActiveEpisodes\">Episodes (24h): --</div>\n      </div>\n      <div class=\"acm-cc__metric-card\">\n        <div class=\"acm-cc__metric-label\">Worst sensor</div>\n        <div class=\"acm-cc__metric-value\" id=\"ccWorstSensor\">--</div>\n        <div class=\"acm-cc__metric-sub\" id=\"ccDaysSinceAlert\">Days since alert: --</div>\n      </div>\n      <div class=\"acm-cc__metric-card\">\n        <div class=\"acm-cc__metric-label\">RUL / Failure risk</div>\n        <div class=\"acm-cc__metric-value\" id=\"ccRUL\">--</div>\n        <div class=\"acm-cc__metric-sub\" id=\"ccFailureRisk\">Failure prob: --</div>\n      </div>\n    </div>\n  </header>\n\n  <!-- MAIN GRID -->\n  <main class=\"acm-cc__main\">\n    <!-- TOP ROW -->\n    <section class=\"acm-cc__row acm-cc__row--top\">\n      <div class=\"acm-cc__panel acm-cc__panel--timeline\">\n        <div class=\"acm-cc__panel-header\">\n          <div class=\"acm-cc__panel-title\">Health &amp; Fused Score Timeline</div>\n          <div class=\"acm-cc__panel-meta\" id=\"ccTimelineMeta\">Last 24 hours</div>\n        </div>\n        <canvas id=\"ccTimelineChart\" class=\"acm-cc__timeline-canvas\"></canvas>\n        <div class=\"acm-cc__legend\">\n          <span class=\"acm-cc__legend-item\">\n            <span class=\"acm-cc__legend-dot acm-cc__legend-dot--health\"></span>Health index\n          </span>\n          <span class=\"acm-cc__legend-item\">\n            <span class=\"acm-cc__legend-dot acm-cc__legend-dot--fused\"></span>Fused z-score\n          </span>\n          <span class=\"acm-cc__legend-item\">\n            <span class=\"acm-cc__legend-pill acm-cc__legend-pill--good\"></span>Good ≥ 85\n          </span>\n          <span class=\"acm-cc__legend-item\">\n            <span class=\"acm-cc__legend-pill acm-cc__legend-pill--watch\"></span>Watch 70–85\n          </span>\n          <span class=\"acm-cc__legend-item\">\n            <span class=\"acm-cc__legend-pill acm-cc__legend-pill--alert\"></span>Alert &lt; 70\n          </span>\n        </div>\n      </div>\n\n      <div class=\"acm-cc__panel acm-cc__panel--gauge\">\n        <div class=\"acm-cc__panel-header\">\n          <div class=\"acm-cc__panel-title\">Current Health Snapshot</div>\n          <div class=\"acm-cc__panel-meta\" id=\"ccZoneBreakdown\">Zone: --</div>\n        </div>\n        <div class=\"acm-cc__gauge-wrap\">\n          <svg class=\"acm-cc__gauge\" viewBox=\"0 0 200 120\">\n            <defs>\n              <linearGradient id=\"ccGaugeGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                <stop offset=\"0%\" stop-color=\"#dc2626\"></stop>\n                <stop offset=\"50%\" stop-color=\"#f97316\"></stop>\n                <stop offset=\"100%\" stop-color=\"#16a34a\"></stop>\n              </linearGradient>\n            </defs>\n            <path\n              d=\"M 20 100 A 80 80 0 0 1 180 100\"\n              fill=\"none\"\n              stroke=\"#e5e7eb\"\n              stroke-width=\"18\"\n            ></path>\n            <path\n              id=\"ccGaugeFill\"\n              d=\"M 20 100 A 80 80 0 0 1 180 100\"\n              fill=\"none\"\n              stroke=\"url(#ccGaugeGradient)\"\n              stroke-width=\"18\"\n              stroke-dasharray=\"251.2\"\n              stroke-dashoffset=\"251.2\"\n            ></path>\n            <text x=\"100\" y=\"83\" class=\"acm-cc__gauge-text\" id=\"ccGaugeText\">--</text>\n          </svg>\n\n          <div class=\"acm-cc__zone-strip\">\n            <div class=\"acm-cc__zone-item\">\n              <span class=\"acm-cc__zone-dot acm-cc__zone-dot--alert\"></span>\n              <span>Alert (&lt; 70)</span>\n            </div>\n            <div class=\"acm-cc__zone-item\">\n              <span class=\"acm-cc__zone-dot acm-cc__zone-dot--watch\"></span>\n              <span>Watch (70–85)</span>\n            </div>\n            <div class=\"acm-cc__zone-item\">\n              <span class=\"acm-cc__zone-dot acm-cc__zone-dot--good\"></span>\n              <span>Good (≥ 85)</span>\n            </div>\n          </div>\n\n          <div class=\"acm-cc__zone-bars\" id=\"ccZoneBars\">\n            <!-- Filled dynamically -->\n          </div>\n        </div>\n\n        <div class=\"acm-cc__panel-subtitle\">Detector contributions</div>\n        <div class=\"acm-cc__contrib-list\" id=\"ccContribList\">\n          <!-- Filled dynamically -->\n        </div>\n      </div>\n    </section>\n\n    <!-- BOTTOM ROW -->\n    <section class=\"acm-cc__row acm-cc__row--bottom\">\n      <!-- Sensor Hotspots -->\n      <div class=\"acm-cc__panel acm-cc__panel--table\">\n        <div class=\"acm-cc__panel-header\">\n          <div class=\"acm-cc__panel-title\">Sensor hotspots (live)</div>\n          <div class=\"acm-cc__panel-meta\" id=\"ccSensorsMeta\">Top 10 by |z|</div>\n        </div>\n        <div class=\"acm-cc__table-wrap\">\n          <table class=\"acm-cc__table\">\n            <thead>\n              <tr>\n                <th>Sensor</th>\n                <th>Status</th>\n                <th>Current z</th>\n                <th>Peak z</th>\n                <th>Current value</th>\n                <th>Normal mean</th>\n              </tr>\n            </thead>\n            <tbody id=\"ccSensorTable\"></tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Episodes -->\n      <div class=\"acm-cc__panel acm-cc__panel--episodes\">\n        <div class=\"acm-cc__panel-header\">\n          <div class=\"acm-cc__panel-title\">Episodes (recent)</div>\n          <div class=\"acm-cc__panel-meta\" id=\"ccEpisodesMeta\">Last 10</div>\n        </div>\n        <div class=\"acm-cc__episode-list\" id=\"ccEpisodeList\"></div>\n\n        <div class=\"acm-cc__panel-subtitle acm-cc__panel-subtitle--compact\">\n          Episode statistics\n        </div>\n        <div class=\"acm-cc__small-grid\" id=\"ccEpisodeStats\">\n          <!-- Filled dynamically (total, avg duration, rate/day, etc.) -->\n        </div>\n      </div>\n\n      <!-- Calibration / Maintenance -->\n      <div class=\"acm-cc__panel acm-cc__panel--side\">\n        <div class=\"acm-cc__panel-header\">\n          <div class=\"acm-cc__panel-title\">Detector calibration</div>\n          <div class=\"acm-cc__panel-meta\">Clip / saturation snapshot</div>\n        </div>\n        <div class=\"acm-cc__table-wrap acm-cc__table-wrap--compact\">\n          <table class=\"acm-cc__table acm-cc__table--small\">\n            <thead>\n              <tr>\n                <th>Detector</th>\n                <th>Mean z</th>\n                <th>P95</th>\n                <th>P99</th>\n                <th>Clip</th>\n                <th>Sat %</th>\n              </tr>\n            </thead>\n            <tbody id=\"ccCalibTable\"></tbody>\n          </table>\n        </div>\n\n        <div class=\"acm-cc__panel-subtitle acm-cc__panel-subtitle--compact\">\n          Maintenance recommendation\n        </div>\n        <div class=\"acm-cc__maint\" id=\"ccMaintBlock\">\n          <div class=\"acm-cc__maint-line\">\n            Earliest: <span id=\"ccMaintEarliest\">--</span>\n          </div>\n          <div class=\"acm-cc__maint-line\">\n            Preferred window: <span id=\"ccMaintWindow\">--</span>\n          </div>\n          <div class=\"acm-cc__maint-line\">\n            Failure prob @ end: <span id=\"ccMaintProb\">--</span>\n          </div>\n        </div>\n      </div>\n    </section>\n  </main>\n</div>\n",
        "onInit": "// Global state & config so that onRender can always see them\nwindow.ccState = window.ccState || {\n  equipmentId: null,\n  regimeLabel: null,\n\n  healthTimeline: [],\n  fusedTimeline: [],\n  healthValue: null,\n  fusedZ: null,\n  status: \"--\",\n  zone: \"--\",\n  zonePct: { GOOD: 0, WATCH: 0, ALERT: 0 },\n  lastUpdate: null,\n\n  worstSensor: null,\n  daysSinceAlert: null,\n  activeEpisodesCount: 0,\n\n  rulHours: null,\n  failureProbNow: null,\n\n  sensors: [],\n  contributions: [],\n  episodes: [],\n  episodeStats: null,\n  calibRows: [],\n  maint: null\n};\n\nwindow.ccConfig = window.ccConfig || {\n  health: {\n    alert: 70,\n    watch: 85\n  },\n  zscore: {\n    warn: 2.0,\n    alert: 3.0\n  }\n};\n\nconsole.log(\"ACM Command Center HTML panel initialised\");\n",
        "onInitOnResize": false,
        "onRender": "// Ensure we have state & config in this scope\nvar ccState = window.ccState || {\n  equipmentId: null,\n  regimeLabel: null,\n\n  healthTimeline: [],\n  fusedTimeline: [],\n  healthValue: null,\n  fusedZ: null,\n  status: \"--\",\n  zone: \"--\",\n  zonePct: { GOOD: 0, WATCH: 0, ALERT: 0 },\n  lastUpdate: null,\n\n  worstSensor: null,\n  daysSinceAlert: null,\n  activeEpisodesCount: 0,\n\n  rulHours: null,\n  failureProbNow: null,\n\n  sensors: [],\n  contributions: [],\n  episodes: [],\n  episodeStats: null,\n  calibRows: [],\n  maint: null\n};\nwindow.ccState = ccState;\n\nvar ccConfig = window.ccConfig || {\n  health: { alert: 70, watch: 85 },\n  zscore: { warn: 2.0, alert: 3.0 }\n};\nwindow.ccConfig = ccConfig;\n\n// ---------- helpers for reading Grafana data ----------\n\nfunction safeGetSeries(data, index) {\n  return data && data.series && data.series[index] ? data.series[index] : null;\n}\n\nfunction seriesToPoints(series) {\n  if (!series || !series.fields || series.fields.length < 2) return [];\n  const tField = series.fields[0];\n  const vField = series.fields[1];\n  const points = [];\n  const len = Math.min(tField.values.length, vField.values.length);\n  for (let i = 0; i < len; i++) {\n    const t = tField.values[i];\n    const v = vField.values[i];\n    if (t == null || v == null) continue;\n    points.push({ time: t, value: v });\n  }\n  return points;\n}\n\nfunction parseCcData(data) {\n  if (!data || !data.series) return;\n\n  // EXPECTED MAPPINGS:\n  // 0: Health timeline (time, HealthIndex)\n  // 1: FusedZ timeline (time, FusedZ) OR latest fusedZ table\n  // 2: Episodes table (Id, Severity, Start, DurationSeconds, PeakZ)\n  // 3: Sensor hotspots table (Sensor, CurrentZ, PeakZ, CurrentVal, NormalMean, Status)\n  // 4: Detector contributions (DetectorType, ContributionPct, ZScore)\n  // 5: Health zone distribution (PeriodStart, Zone, Pct) [optional]\n  // 6: Episode metrics (TotalEpisodes, AvgDurationHours, MaxDurationHours, RatePerDay, MeanInterarrivalHours) [optional]\n  // 7: Calibration summary\n  // 8: RUL summary (RUL_Hours)\n  // 9: Maintenance recommendation window\n  // 10: Failure probability TS or latest value [optional]\n  // 11: Regime / equipment meta [optional]\n\n  // Health timeline\n  const healthSeries = safeGetSeries(data, 0);\n  ccState.healthTimeline = seriesToPoints(healthSeries);\n  if (ccState.healthTimeline.length > 0) {\n    const last = ccState.healthTimeline[ccState.healthTimeline.length - 1];\n    ccState.healthValue = Math.round(last.value);\n    ccState.lastUpdate = new Date(last.time);\n  }\n\n  // Fused z timeline or latest\n  const fusedSeries = safeGetSeries(data, 1);\n  ccState.fusedTimeline = [];\n  ccState.fusedZ = null;\n  if (fusedSeries) {\n    if (fusedSeries.fields.length >= 2 && fusedSeries.fields[0].type === \"time\") {\n      ccState.fusedTimeline = seriesToPoints(fusedSeries);\n      if (ccState.fusedTimeline.length > 0) {\n        ccState.fusedZ = ccState.fusedTimeline[ccState.fusedTimeline.length - 1].value;\n      }\n    } else {\n      const fField = fusedSeries.fields[fusedSeries.fields.length - 1];\n      if (fField.values && fField.values.length > 0) {\n        ccState.fusedZ = Number(fField.values[fField.values.length - 1]) || 0;\n      }\n    }\n  }\n\n  // Episodes\n  const epSeries = safeGetSeries(data, 2);\n  ccState.episodes = [];\n  if (epSeries && epSeries.fields.length >= 5) {\n    const fId = epSeries.fields[0];\n    const fSev = epSeries.fields[1];\n    const fStart = epSeries.fields[2];\n    const fDur = epSeries.fields[3];\n    const fPeak = epSeries.fields[4];\n    const len = fId.values.length;\n    for (let i = 0; i < len; i++) {\n      ccState.episodes.push({\n        id: fId.values[i],\n        severity: fSev.values[i],\n        startTime: fStart.values[i],\n        duration: Number(fDur.values[i]) || 0,\n        peakZ: Number(fPeak.values[i]) || 0\n      });\n    }\n  }\n  ccState.activeEpisodesCount = ccState.episodes.length;\n\n  // Sensors\n  const sensSeries = safeGetSeries(data, 3);\n  ccState.sensors = [];\n  ccState.worstSensor = null;\n  if (sensSeries && sensSeries.fields.length >= 6) {\n    const fName = sensSeries.fields[0];\n    const fCurZ = sensSeries.fields[1];\n    const fPeakZ = sensSeries.fields[2];\n    const fCurVal = sensSeries.fields[3];\n    const fMean = sensSeries.fields[4];\n    const fStatus = sensSeries.fields[5];\n\n    const len = fName.values.length;\n    for (let i = 0; i < len; i++) {\n      const row = {\n        name: String(fName.values[i] || \"\"),\n        currentZ: Number(fCurZ.values[i]) || 0,\n        peakZ: Number(fPeakZ.values[i]) || 0,\n        currentVal: fCurVal.values[i],\n        normalMean: fMean.values[i],\n        status: String(fStatus.values[i] || \"\").toUpperCase()\n      };\n      ccState.sensors.push(row);\n    }\n\n    if (ccState.sensors.length > 0) {\n      const top = [...ccState.sensors].sort(function (a, b) {\n        return Math.abs(b.currentZ) - Math.abs(a.currentZ);\n      })[0];\n      ccState.worstSensor = top.name + \" (z=\" + top.currentZ.toFixed(2) + \")\";\n    }\n  }\n\n  // Detector contributions\n  const contribSeries = safeGetSeries(data, 4);\n  ccState.contributions = [];\n  if (contribSeries && contribSeries.fields.length >= 2) {\n    const fDet = contribSeries.fields[0];\n    const fPct = contribSeries.fields[1];\n    const len = fDet.values.length;\n    for (let i = 0; i < len; i++) {\n      ccState.contributions.push({\n        detector: String(fDet.values[i] || \"\"),\n        pct: Number(fPct.values[i]) || 0\n      });\n    }\n  }\n\n  // Zone distribution (optional)\n  const zoneSeries = safeGetSeries(data, 5);\n  ccState.zonePct = { GOOD: 0, WATCH: 0, ALERT: 0 };\n  if (zoneSeries && zoneSeries.fields.length >= 3) {\n    const fZone = zoneSeries.fields[1];\n    const fPct = zoneSeries.fields[2];\n    const len = fZone.values.length;\n    const agg = { GOOD: 0, WATCH: 0, ALERT: 0 };\n    for (let i = 0; i < len; i++) {\n      const z = String(fZone.values[i] || \"\").toUpperCase();\n      const p = Number(fPct.values[i]) || 0;\n      if (agg[z] != null) agg[z] += p;\n    }\n    ccState.zonePct = agg;\n  }\n\n  // Episode metrics (optional)\n  const epMetricSeries = safeGetSeries(data, 6);\n  ccState.episodeStats = null;\n  if (epMetricSeries && epMetricSeries.fields.length >= 5 && epMetricSeries.fields[0].values.length > 0) {\n    ccState.episodeStats = {\n      total: Number(epMetricSeries.fields[0].values[0]) || 0,\n      avgDur: Number(epMetricSeries.fields[1].values[0]) || 0,\n      maxDur: Number(epMetricSeries.fields[2].values[0]) || 0,\n      rateDay: Number(epMetricSeries.fields[3].values[0]) || 0,\n      interarrival: Number(epMetricSeries.fields[4].values[0]) || 0\n    };\n  }\n\n  // Calibration summary\n  const calibSeries = safeGetSeries(data, 7);\n  ccState.calibRows = [];\n  if (calibSeries && calibSeries.fields.length >= 6) {\n    const fDet = calibSeries.fields[0];\n    const fMean = calibSeries.fields[1];\n    const fP95 = calibSeries.fields[2];\n    const fP99 = calibSeries.fields[3];\n    const fClip = calibSeries.fields[4];\n    const fSat = calibSeries.fields[5];\n    const len = fDet.values.length;\n    for (let i = 0; i < len; i++) {\n      ccState.calibRows.push({\n        det: fDet.values[i],\n        mean: Number(fMean.values[i]) || 0,\n        p95: Number(fP95.values[i]) || 0,\n        p99: Number(fP99.values[i]) || 0,\n        clip: Number(fClip.values[i]) || 0,\n        sat: Number(fSat.values[i]) || 0\n      });\n    }\n  }\n\n  // RUL summary\n  const rulSeries = safeGetSeries(data, 8);\n  ccState.rulHours = null;\n  if (rulSeries && rulSeries.fields.length > 0 && rulSeries.fields[0].values.length > 0) {\n    ccState.rulHours = Number(rulSeries.fields[0].values[0]) || null;\n  }\n\n  // Maintenance recommendation\n  const maintSeries = safeGetSeries(data, 9);\n  ccState.maint = null;\n  if (maintSeries && maintSeries.fields.length >= 4 && maintSeries.fields[0].values.length > 0) {\n    ccState.maint = {\n      earliest: maintSeries.fields[0].values[0],\n      windowStart: maintSeries.fields[1].values[0],\n      windowEnd: maintSeries.fields[2].values[0],\n      probEnd: Number(maintSeries.fields[3].values[0]) || 0\n    };\n  }\n\n  // Failure probability (optional)\n  const fpSeries = safeGetSeries(data, 10);\n  ccState.failureProbNow = null;\n  if (fpSeries) {\n    const f = fpSeries.fields[fpSeries.fields.length - 1];\n    if (f.values && f.values.length > 0) {\n      ccState.failureProbNow = Number(f.values[f.values.length - 1]) || 0;\n    }\n  }\n\n  // Equipment / regime meta (optional)\n  const metaSeries = safeGetSeries(data, 11);\n  if (metaSeries && metaSeries.fields.length >= 2 && metaSeries.fields[0].values.length > 0) {\n    ccState.equipmentId = metaSeries.fields[0].values[0];\n    ccState.regimeLabel = metaSeries.fields[1].values[0];\n  }\n\n  // Derived status and zone\n  if (ccState.healthValue != null) {\n    if (ccState.healthValue >= ccConfig.health.watch) {\n      ccState.status = \"HEALTHY\";\n      ccState.zone = \"GOOD\";\n    } else if (ccState.healthValue >= ccConfig.health.alert) {\n      ccState.status = \"CAUTION\";\n      ccState.zone = \"WATCH\";\n    } else {\n      ccState.status = \"ALERT\";\n      ccState.zone = \"ALERT\";\n    }\n  }\n}\n\n// ---------- formatting helpers ----------\n\nfunction formatShortTimestamp(ts) {\n  if (!ts) return \"--\";\n  const d = new Date(ts);\n  if (Number.isNaN(d.getTime())) return \"--\";\n\n  const now = new Date();\n  const diffMs = now - d;\n  const diffMin = Math.floor(diffMs / 60000);\n  if (diffMin < 1) return \"Just now\";\n  if (diffMin < 60) return diffMin + \"m ago\";\n  const diffH = Math.floor(diffMin / 60);\n  if (diffH < 24) return diffH + \"h ago\";\n\n  const dd = String(d.getDate()).padStart(2, \"0\");\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const hh = String(d.getHours()).padStart(2, \"0\");\n  const min = String(d.getMinutes()).padStart(2, \"0\");\n  return dd + \"/\" + mm + \" \" + hh + \":\" + min;\n}\n\nfunction formatDuration(sec) {\n  if (!sec || sec <= 0) return \"0 s\";\n  if (sec < 60) return sec.toFixed(0) + \" s\";\n  const m = sec / 60;\n  if (m < 60) return m.toFixed(0) + \" min\";\n  const h = m / 60;\n  return h.toFixed(1) + \" h\";\n}\n\n// ---------- rendering functions (header, gauge, timeline, etc.) ----------\n\nfunction renderHeader() {\n  const statusDot = document.getElementById(\"ccStatusDot\");\n  const equipEl = document.getElementById(\"ccEquipId\");\n  const regimeEl = document.getElementById(\"ccRegime\");\n  const lastEl = document.getElementById(\"ccLastUpdate\");\n  const healthValEl = document.getElementById(\"ccHealthValue\");\n  const healthStatusEl = document.getElementById(\"ccHealthStatus\");\n  const fusedEl = document.getElementById(\"ccFusedZ\");\n  const episodesEl = document.getElementById(\"ccActiveEpisodes\");\n  const worstEl = document.getElementById(\"ccWorstSensor\");\n  const daysEl = document.getElementById(\"ccDaysSinceAlert\");\n  const rulEl = document.getElementById(\"ccRUL\");\n  const riskEl = document.getElementById(\"ccFailureRisk\");\n\n  if (statusDot) {\n    statusDot.className = \"acm-cc__status-dot\";\n    if (ccState.status === \"ALERT\") statusDot.classList.add(\"acm-cc__status-dot--alert\");\n    else if (ccState.status === \"CAUTION\") statusDot.classList.add(\"acm-cc__status-dot--watch\");\n  }\n\n  if (equipEl) {\n    equipEl.textContent = \"Equipment: \" + (ccState.equipmentId || \"--\");\n  }\n  if (regimeEl) {\n    regimeEl.textContent = \"Regime: \" + (ccState.regimeLabel || \"--\");\n  }\n  if (lastEl) {\n    lastEl.textContent =\n      \"Last update: \" +\n      (ccState.lastUpdate ? formatShortTimestamp(ccState.lastUpdate) : \"--\");\n  }\n  if (healthValEl) {\n    healthValEl.textContent =\n      ccState.healthValue != null ? String(ccState.healthValue) : \"--\";\n  }\n  if (healthStatusEl) {\n    healthStatusEl.textContent = \"Status: \" + (ccState.status || \"--\");\n  }\n  if (fusedEl) {\n    fusedEl.textContent =\n      ccState.fusedZ != null ? ccState.fusedZ.toFixed(2) : \"--\";\n  }\n  if (episodesEl) {\n    episodesEl.textContent =\n      \"Episodes (24h): \" + (ccState.activeEpisodesCount || 0);\n  }\n  if (worstEl) {\n    worstEl.textContent = ccState.worstSensor || \"--\";\n  }\n\n  if (daysEl) {\n    daysEl.textContent = \"Days since alert: --\";\n    const alerts = ccState.episodes.filter(function (e) {\n      const sev = String(e.severity || \"\").toUpperCase();\n      return sev === \"HIGH\" || sev === \"CRITICAL\" || sev === \"ALERT\";\n    });\n    if (alerts.length > 0) {\n      const latest = alerts\n        .slice()\n        .sort(function (a, b) {\n          return new Date(b.startTime) - new Date(a.startTime);\n        })[0];\n      const diffDays =\n        (Date.now() - new Date(latest.startTime).getTime()) /\n        (1000 * 3600 * 24);\n      daysEl.textContent = \"Days since alert: \" + diffDays.toFixed(1);\n    }\n  }\n\n  if (rulEl) {\n    rulEl.textContent =\n      ccState.rulHours != null ? ccState.rulHours.toFixed(0) + \" h\" : \"--\";\n  }\n  if (riskEl) {\n    riskEl.textContent =\n      ccState.failureProbNow != null\n        ? (ccState.failureProbNow * 100).toFixed(1) + \" %\"\n        : \"--\";\n  }\n}\n\nfunction renderGaugeAndZones() {\n  const gaugeFill = document.getElementById(\"ccGaugeFill\");\n  const gaugeText = document.getElementById(\"ccGaugeText\");\n  const zoneMeta = document.getElementById(\"ccZoneBreakdown\");\n  const zoneBarsContainer = document.getElementById(\"ccZoneBars\");\n\n  const hv = ccState.healthValue != null ? ccState.healthValue : 0;\n  const clamped = Math.max(0, Math.min(100, hv));\n  const offset = 251.2 - (clamped / 100) * 251.2;\n\n  if (gaugeFill) {\n    gaugeFill.style.strokeDashoffset = offset;\n  }\n  if (gaugeText) {\n    gaugeText.textContent =\n      ccState.healthValue != null ? String(ccState.healthValue) : \"--\";\n  }\n\n  if (zoneMeta) {\n    zoneMeta.textContent =\n      \"Zone: \" +\n      (ccState.zone || \"--\") +\n      \" | GOOD \" +\n      ccState.zonePct.GOOD.toFixed(0) +\n      \"%, WATCH \" +\n      ccState.zonePct.WATCH.toFixed(0) +\n      \"%, ALERT \" +\n      ccState.zonePct.ALERT.toFixed(0) +\n      \"%\";\n  }\n\n  if (!zoneBarsContainer) return;\n  zoneBarsContainer.innerHTML = \"\";\n\n  const zones = [\n    { key: \"GOOD\", label: \"Good\", color: \"var(--acm-status-good)\" },\n    { key: \"WATCH\", label: \"Watch\", color: \"var(--acm-status-watch)\" },\n    { key: \"ALERT\", label: \"Alert\", color: \"var(--acm-status-alert)\" }\n  ];\n\n  zones.forEach(function (z) {\n    const pct = ccState.zonePct[z.key] || 0;\n    const wrap = document.createElement(\"div\");\n    wrap.className = \"acm-cc__zone-bar\";\n    const fill = document.createElement(\"div\");\n    fill.className = \"acm-cc__zone-bar-fill\";\n    fill.style.background = z.color;\n    fill.style.width = Math.max(2, Math.min(100, pct)) + \"%\";\n    const label = document.createElement(\"div\");\n    label.className = \"acm-cc__zone-bar-label\";\n    label.textContent = z.label + \" \" + pct.toFixed(0) + \"%\";\n    wrap.appendChild(fill);\n    wrap.appendChild(label);\n    zoneBarsContainer.appendChild(wrap);\n  });\n}\n\nfunction renderTimeline() {\n  const canvas = document.getElementById(\"ccTimelineChart\");\n  if (!canvas || ccState.healthTimeline.length === 0) return;\n\n  const ctx = canvas.getContext(\"2d\");\n  const rect = canvas.getBoundingClientRect();\n  const dpr = window.devicePixelRatio || 1;\n\n  canvas.width = rect.width * dpr;\n  canvas.height = rect.height * dpr;\n  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n\n  const width = rect.width;\n  const height = rect.height;\n  ctx.clearRect(0, 0, width, height);\n\n  const padding = { top: 12, right: 20, bottom: 22, left: 40 };\n  const cw = width - padding.left - padding.right;\n  const ch = height - padding.top - padding.bottom;\n\n  // Background\n  ctx.fillStyle = \"#ffffff\";\n  ctx.fillRect(0, 0, width, height);\n\n  // Grid\n  ctx.strokeStyle = \"#e5e7eb\";\n  ctx.lineWidth = 1;\n  ctx.setLineDash([3, 3]);\n  for (let i = 0; i <= 5; i++) {\n    const y = padding.top + (ch / 5) * i;\n    ctx.beginPath();\n    ctx.moveTo(padding.left, y);\n    ctx.lineTo(padding.left + cw, y);\n    ctx.stroke();\n  }\n  ctx.setLineDash([]);\n\n  // Threshold lines\n  const alertY = padding.top + ch * (1 - ccConfig.health.alert / 100);\n  const watchY = padding.top + ch * (1 - ccConfig.health.watch / 100);\n\n  ctx.strokeStyle = \"#fecaca\";\n  ctx.lineWidth = 1.2;\n  ctx.setLineDash([4, 4]);\n  ctx.beginPath();\n  ctx.moveTo(padding.left, alertY);\n  ctx.lineTo(padding.left + cw, alertY);\n  ctx.stroke();\n\n  ctx.strokeStyle = \"#fed7aa\";\n  ctx.beginPath();\n  ctx.moveTo(padding.left, watchY);\n  ctx.lineTo(padding.left + cw, watchY);\n  ctx.stroke();\n  ctx.setLineDash([]);\n\n  // Y axis labels\n  ctx.fillStyle = \"#9ca3af\";\n  ctx.font = \"10px \" + getComputedStyle(document.body).fontFamily;\n  ctx.textAlign = \"right\";\n  ctx.textBaseline = \"middle\";\n  for (let i = 0; i <= 5; i++) {\n    const val = 100 - i * 20;\n    const y = padding.top + (ch / 5) * i;\n    ctx.fillText(String(val), padding.left - 6, y);\n  }\n\n  const n = ccState.healthTimeline.length;\n  if (n < 2) return;\n\n  function xPos(idx) {\n    return padding.left + (cw * idx) / (n - 1);\n  }\n  function yFromPercent(pct) {\n    return padding.top + ch * (1 - pct / 100);\n  }\n\n  // Health line\n  ctx.strokeStyle = \"#2563eb\";\n  ctx.lineWidth = 1.8;\n  ctx.beginPath();\n  ccState.healthTimeline.forEach(function (pt, i) {\n    const x = xPos(i);\n    const y = yFromPercent(pt.value);\n    if (i === 0) ctx.moveTo(x, y);\n    else ctx.lineTo(x, y);\n  });\n  ctx.stroke();\n\n  // Fused z line (scaled |z| -> 0–100)\n  if (ccState.fusedTimeline && ccState.fusedTimeline.length > 0) {\n    ctx.strokeStyle = \"#7c2d12\";\n    ctx.lineWidth = 1.2;\n    ctx.setLineDash([6, 4]);\n    ctx.beginPath();\n    ccState.fusedTimeline.forEach(function (pt, i) {\n      const x = xPos(i);\n      const scaled = Math.max(\n        0,\n        Math.min(100, 100 - (Math.abs(pt.value) / 6) * 100)\n      );\n      const y = padding.top + ch * (1 - scaled / 100);\n      if (i === 0) ctx.moveTo(x, y);\n      else ctx.lineTo(x, y);\n    });\n    ctx.stroke();\n    ctx.setLineDash([]);\n  }\n\n  const metaEl = document.getElementById(\"ccTimelineMeta\");\n  if (metaEl && ccState.healthTimeline.length > 1) {\n    const first = ccState.healthTimeline[0];\n    const last = ccState.healthTimeline[ccState.healthTimeline.length - 1];\n    metaEl.textContent =\n      \"From \" +\n      formatShortTimestamp(first.time) +\n      \" to \" +\n      formatShortTimestamp(last.time);\n  }\n}\n\nfunction renderContributions() {\n  const container = document.getElementById(\"ccContribList\");\n  if (!container) return;\n  container.innerHTML = \"\";\n\n  if (!ccState.contributions || ccState.contributions.length === 0) {\n    container.textContent = \"No detector contribution data\";\n    return;\n  }\n\n  const top = ccState.contributions\n    .slice()\n    .sort(function (a, b) {\n      return b.pct - a.pct;\n    })\n    .slice(0, 6);\n\n  top.forEach(function (c) {\n    const row = document.createElement(\"div\");\n    row.className = \"acm-cc__contrib-row\";\n\n    const label = document.createElement(\"div\");\n    label.className = \"acm-cc__contrib-label\";\n    label.textContent = String(c.detector || \"\").toUpperCase();\n\n    const track = document.createElement(\"div\");\n    track.className = \"acm-cc__contrib-track\";\n\n    const fill = document.createElement(\"div\");\n    fill.className = \"acm-cc__contrib-fill\";\n    fill.style.width = Math.max(2, Math.min(100, c.pct)) + \"%\";\n\n    const val = document.createElement(\"div\");\n    val.className = \"acm-cc__contrib-value\";\n    val.textContent = c.pct.toFixed(1) + \"%\";\n\n    track.appendChild(fill);\n    track.appendChild(val);\n\n    row.appendChild(label);\n    row.appendChild(track);\n    container.appendChild(row);\n  });\n}\n\nfunction renderSensors() {\n  const tbody = document.getElementById(\"ccSensorTable\");\n  const meta = document.getElementById(\"ccSensorsMeta\");\n  if (!tbody) return;\n  tbody.innerHTML = \"\";\n\n  if (!ccState.sensors || ccState.sensors.length === 0) {\n    const tr = document.createElement(\"tr\");\n    const td = document.createElement(\"td\");\n    td.colSpan = 6;\n    td.style.textAlign = \"center\";\n    td.style.padding = \"16px\";\n    td.style.color = \"#9ca3af\";\n    td.textContent = \"No sensor hotspot data\";\n    tr.appendChild(td);\n    tbody.appendChild(tr);\n    if (meta) meta.textContent = \"No data\";\n    return;\n  }\n\n  const sorted = ccState.sensors\n    .slice()\n    .sort(function (a, b) {\n      return Math.abs(b.currentZ) - Math.abs(a.currentZ);\n    })\n    .slice(0, 10);\n\n  sorted.forEach(function (s) {\n    const tr = document.createElement(\"tr\");\n\n    const tdName = document.createElement(\"td\");\n    tdName.textContent = s.name || \"\";\n    tr.appendChild(tdName);\n\n    const tdStatus = document.createElement(\"td\");\n    const chip = document.createElement(\"span\");\n    const st = String(s.status || \"\").toUpperCase();\n    chip.className = \"acm-cc__chip \";\n    if (st === \"ALERT\") chip.className += \"acm-cc__chip--alert\";\n    else if (st === \"WARN\" || st === \"WARNING\")\n      chip.className += \"acm-cc__chip--warn\";\n    else chip.className += \"acm-cc__chip--good\";\n    chip.textContent = st || \"NORMAL\";\n    tdStatus.appendChild(chip);\n    tr.appendChild(tdStatus);\n\n    const tdCur = document.createElement(\"td\");\n    tdCur.textContent = s.currentZ.toFixed(2);\n    tr.appendChild(tdCur);\n\n    const tdPeak = document.createElement(\"td\");\n    tdPeak.textContent = s.peakZ.toFixed(2);\n    tr.appendChild(tdPeak);\n\n    const tdVal = document.createElement(\"td\");\n    tdVal.textContent =\n      s.currentVal != null && s.currentVal !== \"\" ? String(s.currentVal) : \"--\";\n    tr.appendChild(tdVal);\n\n    const tdMean = document.createElement(\"td\");\n    tdMean.textContent =\n      s.normalMean != null && s.normalMean !== \"\"\n        ? String(s.normalMean)\n        : \"--\";\n    tr.appendChild(tdMean);\n\n    tbody.appendChild(tr);\n  });\n\n  if (meta) {\n    meta.textContent =\n      \"Top \" + sorted.length + \" by |z| (total \" + ccState.sensors.length + \")\";\n  }\n}\n\nfunction renderEpisodes() {\n  const container = document.getElementById(\"ccEpisodeList\");\n  const meta = document.getElementById(\"ccEpisodesMeta\");\n  const statsContainer = document.getElementById(\"ccEpisodeStats\");\n\n  if (container) {\n    container.innerHTML = \"\";\n    if (!ccState.episodes || ccState.episodes.length === 0) {\n      const div = document.createElement(\"div\");\n      div.style.padding = \"12px\";\n      div.style.textAlign = \"center\";\n      div.style.color = \"#9ca3af\";\n      div.textContent = \"No recent episodes\";\n      container.appendChild(div);\n    } else {\n      const latest = ccState.episodes\n        .slice()\n        .sort(function (a, b) {\n          return new Date(b.startTime) - new Date(a.startTime);\n        })\n        .slice(0, 8);\n\n      latest.forEach(function (ep) {\n        const item = document.createElement(\"div\");\n        item.className = \"acm-cc__episode-item\";\n\n        const header = document.createElement(\"div\");\n        header.className = \"acm-cc__episode-header\";\n\n        const id = document.createElement(\"div\");\n        id.className = \"acm-cc__episode-id\";\n        id.textContent = \"EP-\" + String(ep.id).padStart(3, \"0\");\n\n        const badge = document.createElement(\"div\");\n        const sev = String(ep.severity || \"\").toUpperCase();\n        badge.className = \"acm-cc__episode-badge \";\n        if (sev === \"CRITICAL\")\n          badge.className += \"acm-cc__episode-badge--critical\";\n        else if (sev === \"HIGH\" || sev === \"ALERT\")\n          badge.className += \"acm-cc__episode-badge--high\";\n        else if (sev === \"LOW\")\n          badge.className += \"acm-cc__episode-badge--low\";\n        else badge.className += \"acm-cc__episode-badge--medium\";\n        badge.textContent = sev || \"MEDIUM\";\n\n        header.appendChild(id);\n        header.appendChild(badge);\n\n        const body = document.createElement(\"div\");\n        body.className = \"acm-cc__episode-body\";\n        body.textContent =\n          \"Peak z \" +\n          (ep.peakZ || 0).toFixed(2) +\n          \" • Duration \" +\n          formatDuration(ep.duration || 0);\n\n        const metaLine = document.createElement(\"div\");\n        metaLine.className = \"acm-cc__episode-meta\";\n        metaLine.textContent = formatShortTimestamp(ep.startTime);\n\n        item.appendChild(header);\n        item.appendChild(body);\n        item.appendChild(metaLine);\n        container.appendChild(item);\n      });\n    }\n  }\n\n  if (meta) {\n    meta.textContent =\n      \"Last \" + (ccState.episodes ? ccState.episodes.length : 0) + \" episodes\";\n  }\n\n  if (statsContainer) {\n    statsContainer.innerHTML = \"\";\n    if (!ccState.episodeStats) return;\n    const s = ccState.episodeStats;\n    const items = [\n      { label: \"Total episodes\", value: s.total.toFixed(0) },\n      { label: \"Avg duration (h)\", value: s.avgDur.toFixed(1) },\n      { label: \"Max duration (h)\", value: s.maxDur.toFixed(1) },\n      { label: \"Episodes / day\", value: s.rateDay.toFixed(2) },\n      { label: \"Interarrival (h)\", value: s.interarrival.toFixed(1) }\n    ];\n    items.forEach(function (it) {\n      const card = document.createElement(\"div\");\n      card.className = \"acm-cc__small-stat\";\n      const l = document.createElement(\"div\");\n      l.className = \"acm-cc__small-stat-label\";\n      l.textContent = it.label;\n      const v = document.createElement(\"div\");\n      v.className = \"acm-cc__small-stat-value\";\n      v.textContent = it.value;\n      card.appendChild(l);\n      card.appendChild(v);\n      statsContainer.appendChild(card);\n    });\n  }\n}\n\nfunction renderCalibration() {\n  const tbody = document.getElementById(\"ccCalibTable\");\n  if (!tbody) return;\n  tbody.innerHTML = \"\";\n\n  if (!ccState.calibRows || ccState.calibRows.length === 0) {\n    const tr = document.createElement(\"tr\");\n    const td = document.createElement(\"td\");\n    td.colSpan = 6;\n    td.style.textAlign = \"center\";\n    td.style.padding = \"10px\";\n    td.style.color = \"#9ca3af\";\n    td.textContent = \"No calibration summary\";\n    tr.appendChild(td);\n    tbody.appendChild(tr);\n    return;\n  }\n\n  ccState.calibRows.forEach(function (r) {\n    const tr = document.createElement(\"tr\");\n    function append(val) {\n      const td = document.createElement(\"td\");\n      td.textContent = val;\n      tr.appendChild(td);\n    }\n    append(String(r.det || r.detector || \"\"));\n    append(r.mean.toFixed(2));\n    append(r.p95.toFixed(2));\n    append(r.p99.toFixed(2));\n    append(r.clip.toFixed(1));\n    append(r.sat.toFixed(1));\n    tbody.appendChild(tr);\n  });\n}\n\nfunction renderMaintenance() {\n  const earliestEl = document.getElementById(\"ccMaintEarliest\");\n  const windowEl = document.getElementById(\"ccMaintWindow\");\n  const probEl = document.getElementById(\"ccMaintProb\");\n\n  if (!ccState.maint) {\n    if (earliestEl) earliestEl.textContent = \"--\";\n    if (windowEl) windowEl.textContent = \"--\";\n    if (probEl) probEl.textContent = \"--\";\n    return;\n  }\n\n  if (earliestEl) earliestEl.textContent = formatShortTimestamp(ccState.maint.earliest);\n  if (windowEl) {\n    windowEl.textContent =\n      formatShortTimestamp(ccState.maint.windowStart) +\n      \" → \" +\n      formatShortTimestamp(ccState.maint.windowEnd);\n  }\n  if (probEl) {\n    probEl.textContent = ccState.maint.probEnd.toFixed(1) + \" %\";\n  }\n}\n\n// ---------- MAIN ENTRY ----------\n\n// Only parse when there is actual data; no dummy data branch\nif (typeof data !== \"undefined\" && data && data.series && data.series.length > 0) {\n  parseCcData(data);\n} else {\n  console.warn(\"ACM Command Center: no data.series returned from datasource\");\n}\n\n// Render whatever state we currently have (may be empty, which shows 'No data' placeholders)\nrenderHeader();\nrenderGaugeAndZones();\nrenderTimeline();\nrenderContributions();\nrenderSensors();\nrenderEpisodes();\nrenderCalibration();\nrenderMaintenance();\n\n// Redraw timeline on resize once per page\nif (!window.__acmCcResizeHandler) {\n  window.__acmCcResizeHandler = function () {\n    clearTimeout(window.__acmCcResizeTimeout);\n    window.__acmCcResizeTimeout = setTimeout(renderTimeline, 200);\n  };\n  window.addEventListener(\"resize\", window.__acmCcResizeHandler);\n}\n",
        "overflow": "visible",
        "panelupdateOnMount": true,
        "reduceOptions": {
          "calcs": [
            "lastNotNull",
            "last",
            "firstNotNull",
            "first",
            "min",
            "max",
            "mean",
            "sum",
            "count",
            "range",
            "delta",
            "step",
            "diff",
            "logmin",
            "allIsZero",
            "allIsNull",
            "diffperc"
          ]
        },
        "renderOnMount": true,
        "rootCSS": ":root {\r\n  /* Light theme palette */\r\n  --acm-bg-page: #f5f5f7;\r\n  --acm-bg-panel: #ffffff;\r\n  --acm-bg-header: #f9fafb;\r\n  --acm-border-soft: #e5e7eb;\r\n  --acm-border-strong: #d4d4d8;\r\n\r\n  --acm-text-main: #111827;\r\n  --acm-text-muted: #6b7280;\r\n  --acm-text-soft: #9ca3af;\r\n\r\n  --acm-status-good: #16a34a;\r\n  --acm-status-watch: #f97316;\r\n  --acm-status-alert: #dc2626;\r\n  --acm-status-critical: #b91c1c;\r\n\r\n  --acm-accent: #2563eb;\r\n  --acm-accent-soft: #dbeafe;\r\n\r\n  --acm-radius-sm: 4px;\r\n  --acm-radius-md: 6px;\r\n  --acm-radius-lg: 10px;\r\n\r\n  --acm-space-xs: 4px;\r\n  --acm-space-sm: 8px;\r\n  --acm-space-md: 12px;\r\n  --acm-space-lg: 16px;\r\n  --acm-space-xl: 20px;\r\n\r\n  --acm-font-sans: -apple-system, BlinkMacSystemFont, \"Segoe UI\", system-ui, sans-serif;\r\n  --acm-font-mono: \"Consolas\", \"SFMono-Regular\", Menlo, monospace;\r\n}\r\n",
        "useGrafanaScrollbar": false
      },
      "pluginVersion": "2.2.1",
      "targets": [
        {
          "datasource": {
            "type": "datasource",
            "uid": "grafana"
          },
          "queryType": "randomWalk",
          "refId": "A"
        }
      ],
      "title": "New panel",
      "transparent": true,
      "type": "gapit-htmlgraphics-panel"
    }
  ],
  "preload": false,
  "schemaVersion": 42,
  "tags": [],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "ACM - 1",
  "uid": "adtx9t8",
  "version": 8
}