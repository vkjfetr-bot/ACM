# Grafana Pyroscope Configuration for ACM
# =========================================
# Minimal local deployment - stores profiles in local filesystem
#
# Start with: pyroscope -config.file=pyroscope.yaml
# UI/API: http://localhost:4040
#
# Push profiles via HTTP:
#   POST http://localhost:4040/ingest
#   Content-Type: application/octet-stream

# Run all components in single process
target: all

server:
  http_listen_port: 4040
  grpc_listen_port: 4041
  log_level: info

# Local filesystem storage
storage:
  backend: filesystem
  filesystem:
    dir: ./pyroscope-data

# Memberlist for single-node mode
memberlist:
  join_members: []

# Disable self-profiling push (we're the server)
self-profiling:
  disable-push: true

# Ingester settings
ingester:
  lifecycler:
    ring:
      replication_factor: 1

# Compactor settings
compactor:
  compaction_interval: 30s
  
# Limits - generous for local development
limits:
  max_query_length: 24h
  max_query_lookback: 168h  # 7 days
  ingestion_rate_mb: 4
  ingestion_burst_size_mb: 2

# Scrape configs - empty for push-only mode
# ACM uses push-based profiling via pyroscope-io SDK
scrape-configs: []
