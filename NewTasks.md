| Task ID      | Module / Area                                           | What to fix                                                  | Where to fix it (file / concept)                                                                          | What exactly to do                                                                                                                                                                                                                                                                                                                                                                                    | Benefit / Impact                                                                                                                                                                         |                                                                                                                                                                       |
| ------------ | ------------------------------------------------------- | ------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TIME-01      | Time handling consistency                               | UTC vs local naive inconsistency                             | `enhanced_forecasting.py`, `rul_estimator.py`, `enhanced_rul_estimator.py`                                | Remove `utc=True` in all `pd.to_datetime` calls, drop any `tz_localize` / `tz_convert` logic, and standardise to naive timestamps (same as main ACM). Add a small helper like `ensure_naive_local_index(df, "Timestamp")` and call it at entry points.                                                                                                                                                | Prevent subtle joins and comparisons from breaking when merging with `scores.csv` or SQL tables that assume local naive time. Eliminates “empty joins” and off-by-hours bugs.            |                                                                                                                                                                       |
| TIME-02      | SQL timestamp policy alignment                          | Assume same time basis as `output_manager` / main SQL writer | `enhanced_forecasting_sql.py` and any SQL read helpers it uses                                            | After TIME-01, ensure that data loaded from `ACM_HealthTimeline` and `ACM_Scores_Wide` is treated as naive, without converting to UTC. Explicitly document in a module-level docstring that the RUL / forecast stack follows the same timestamp policy as ACM core.                                                                                                                                   | One time policy for entire platform, simplifies debugging and prevents Grafana panels from showing “shifted” forecast or RUL timelines.                                                  |                                                                                                                                                                       |
| STACK-01     | Multiple forecast stacks with no canonical choice       | Overlapping “simple” vs “enhanced” RUL / forecasting         | `rul_estimator.py`, `enhanced_rul_estimator.py`, `forecast.py`, `enhanced_forecasting.py`, `acm_main.py`  | Decide the future-default stack: simple or enhanced. Add a configuration flag (for example `forecast.mode = "simple"                                                                                                                                                                                                                                                                                  | "enhanced"`) loaded from ACM config. In `acm_main.py` add a single orchestration point that calls the chosen stack and disable direct ad-hoc usage of the other in production.           | Avoids confusion about which module is “truth” when debugging, and ensures operators see a single, consistent picture of RUL / forecast rather than competing charts. |
| STACK-02     | Duplicate helper logic in RUL modules                   | Same low-level maths duplicated                              | `rul_estimator.py`, `enhanced_rul_estimator.py`                                                           | Extract common helpers such as `_norm_cdf`, basic `RULConfig`, and any simple AR1 estimation into a shared helper (for example `rul_common.py` or functions inside `enhanced_rul_estimator` and used by `rul_estimator`). Replace duplicated code with imports.                                                                                                                                       | Reduces maintenance burden and risk of the two paths drifting apart numerically. A bug fix in one place automatically benefits both implementations.                                     |                                                                                                                                                                       |
| OUT-FORE-01  | Forecast/RUL tables bypass OutputManager                | No batching / default filling / health checks                | `enhanced_forecasting_sql.py`, `rul_estimator.py`, `enhanced_rul_estimator.py`, `output_manager.py`       | Decide which forecast/RUL tables are first class (for example `ACM_HealthForecast_TS`, `ACM_FailureForecast_TS`, `ACM_RUL_TS`, `ACM_RUL_Summary`, `ACM_RUL_Attribution`). Add them to `OutputManager.ALLOWED_TABLES` with default column definitions, then route all forecast/RUL writes through OutputManager instead of manual `to_sql` or ad-hoc writers.                                          | Gains all existing protections (transaction batching, default values, missing-column safeguards, SQL health checks) for the new tables, and gives a single, uniform write path to debug. |                                                                                                                                                                       |
| OUT-FORE-02  | Forecast/RUL schema not documented alongside ACM tables | Contracts only implicit in code                              | `output_manager.py` (docstring / schema section), plus a short markdown spec in your docs                 | Add a “Forecast and RUL Tables” section near the existing table contract list in `output_manager.py`, documenting each table’s required columns, optional columns, and usage. Make sure names match exactly what the enhanced modules expect.                                                                                                                                                         | Clear reference for future changes, reduces risk of silent schema drift, and helps when you or others create Grafana panels or SQL views on top of these tables.                         |                                                                                                                                                                       |
| CFG-FORE-01  | Hard-coded configs for enhanced forecasting             | Configs not tied into ACM config table                       | `enhanced_forecasting.py` and `enhanced_forecasting_sql.py`                                               | Replace hard-coded defaults for `ForecastConfig`, `MaintenanceConfig`, and `CausationConfig` with parameters loaded from the global ACM config (for example mapping sections like `forecast.horizon_hours`, `forecast.min_history_days`, `maint.min_separation_hours`). Add a single adapter function that builds these config objects from the existing config rows.                                 | All knobs live in one place (ACM_Config / `config_table.csv`), enabling per-asset tuning and making behaviour reproducible between file mode and SQL mode.                               |                                                                                                                                                                       |
| CFG-RUL-01   | RUL behaviour not configurable via ACM config           | RULConfig is internal                                        | `rul_estimator.py`, `enhanced_rul_estimator.py`                                                           | Create a mapping from ACM config to `RULConfig` (for example reserve keys like `rul.target_health`, `rul.max_horizon_days`, `rul.confidence_level`). Instantiate RULConfig through a helper that reads from ACM config rather than hard-coded values.                                                                                                                                                 | Unified configuration story: operators can adjust RUL sensitivity and horizons per asset through the same mechanism they use for detectors and regimes.                                  |                                                                                                                                                                       |
| PERSIST-01   | No persistence model for adaptive learning state        | Adaptive RUL learning state lost between runs                | `enhanced_rul_estimator.py`, `model_persistence.py` (or a new SQL table)                                  | Decide where to store `ModelPerformanceMetrics` / `LearningState`: either extend `model_persistence` to include a “RUL state” section in the manifest, or create a dedicated SQL table (for example `ACM_RUL_LearningState`). Implement load/save functions that are called at the start and end of each enhanced RUL run.                                                                            | Makes “adaptive” RUL truly adaptive across runs, not only within a single execution. Improves stability of RUL predictions and enables tracking of long-term model performance.          |                                                                                                                                                                       |
| INTEG-01     | Enhanced forecasting not wired into main pipeline       | Currently a side-module                                      | `acm_main.py`, `enhanced_forecasting_sql.py`                                                              | Add a clearly named orchestration function (for example `run_enhanced_forecasting_for_asset(equip_id, run_ctx, conn)`) that is called from `acm_main` after scores and health timeline have been written. That function should call `enhanced_forecasting_sql` to compute dataframes, then hand them to `OutputManager` for writing. Protect with a config flag so it can be turned on/off per asset. | Ensures forecasting is part of the standard ACM run, with the same logging, error handling, and run-ID structure as the rest of the pipeline. No more “shadow job” feeling.              |                                                                                                                                                                       |
| INTEG-02     | Simple vs enhanced RUL integration path undefined       | Both modules appear as peers                                 | `acm_main.py`, `enhanced_forecasting_sql.py`, `rul_estimator.py`, `enhanced_rul_estimator.py`             | After STACK-01, implement a single function that computes RUL given the health timeline and optionally detector scores. Internally switch between `rul_estimator` and `enhanced_rul_estimator` based on config; externally expose only that single function to the rest of the system.                                                                                                                | Simplifies call-sites, reduces the number of places that need to know about implementation details, and makes swapping RUL engines transparent to the rest of the code.                  |                                                                                                                                                                       |
| DOC-01       | Lack of explicit I/O contracts for new modules          | What they read/write is only visible from code               | `enhanced_forecasting.py`, `enhanced_forecasting_sql.py`, `rul_estimator.py`, `enhanced_rul_estimator.py` | At the top of each module, add a short “Contracts” section stating: required input tables and columns, output tables and columns, timestamp policy, and config keys. Keep this synchronised with the spec in `output_manager.py`.                                                                                                                                                                     | Reduces onboarding time, makes audits easier, and cuts down future “why is my column missing” debugging.                                                                                 |                                                                                                                                                                       |
| SMART-01     | Coldstart state machine not integrated                  | `smart_coldstart.py` is unused                               | `smart_coldstart.py`, SQL start-run codepath in `acm_main.py` or the SQL wrapper scripts                  | Identify the SQL flow where you currently check “enough data for training/score.” Replace ad-hoc checks with a `ColdstartState` instance that accumulates row counts and cadence over multiple runs. Persist the state per asset to an SQL table (for example `ACM_ColdstartState`) or a small JSON in `artifacts/{equip}/`.                                                                          | Helps SQL-mode assets to “warm up” gradually without failing jobs, and gives you a structured view of how long a new asset needs before full ACM can start.                              |                                                                                                                                                                       |
| SMART-02     | Naming assumptions for coldstart tables                 | Uses `{equip}_Data` pattern implicitly                       | `smart_coldstart.py` and any SQL wrappers that call it                                                    | Make the table/view names used by coldstart configurable rather than hard-coded patterns. For example, pass the source table/view name into the coldstart functions (taken from ACM config) instead of constructing names internally. Document this contract.                                                                                                                                         | Allows coldstart logic to work across plants and historian schemas without forcing a particular naming scheme. Lower chance of silent mismatch with your real historian view names.      |                                                                                                                                                                       |
| FORE-QUAL-01 | Enhanced forecasting complexity vs testability          | Many responsibilities in one module                          | `enhanced_forecasting.py`                                                                                 | Split the module into clearer sub-pieces: keep low-level models and failure probability in one section, causation analysis in another, and maintenance recommendation logic in a separate class or even separate module. Add unit-level tests around each piece (even informal test harnesses).                                                                                                       | Easier to reason about results and isolate bugs when forecasts, causation, or maintenance suggestions look wrong. Better mapping from code to operator-facing charts.                    |                                                                                                                                                                       |
| GRAF-FORE-01 | No clear mapping from forecast outputs to dashboards    | Operators need intuitive charts                              | `enhanced_forecasting.py`, `rul_estimator.py`, `output_manager.py`, dashboard JSON later                  | For each forecast/RUL table, define which Grafana panel type and field mapping you intend to use (for example step graph for `HealthForecast`, bar for `FailureProbability`, single-stat with trend for `RUL_Summary`). Ensure table columns are named to support this cleanly (no cryptic names). Add this intent as comments near the table contract.                                               | Makes it much easier to design meaningful Grafana panels later and ensures the data structure is aligned with how you want to visualise it.                                              |                                                                                                                                                                       |
| PERF-FORE-01 | Potential duplication of AR1 logic                      | AR1 for detector vs AR1 for health                           | `forecast.py`, `enhanced_forecasting.py`, `rul_estimator.py` if applicable                                | Centralise AR1 fitting and forecasting in a small shared helper (for example `forecast_ar1(series, horizon_steps, cfg)`), used by both detector-oriented and health-oriented forecasts. Make sure it has clear options for clipping and near-unit-root behaviour.                                                                                                                                     | Less code to maintain and better consistency between detector forecasts and health / RUL projections built on top of them.                                                               |                                                                                                                                                                       |
| LOG-01       | Logging and run context for new modules                 | Logs not fully integrated into main run logger               | `enhanced_forecasting.py`, `enhanced_forecasting_sql.py`, `rul_estimator.py`, `enhanced_rul_estimator.py` | Replace ad-hoc `print` or custom logs with the standard `Console` / logger used in `acm_main`. Include equip ID, run ID, and regime info in messages. Ensure forecasting and RUL stages appear in the central “TIMER” block where applicable.                                                                                                                                                         | Unified logs make it possible to follow a full run end-to-end, including forecasting and RUL, without chasing multiple log styles. Easier RCA when results look off.                     |                                                                                                                                                                       |
